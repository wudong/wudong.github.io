<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Warren Liu (Posts about java)</title><link>https://wudong.graceliu.uk/</link><description></description><atom:link href="https://wudong.graceliu.uk/categories/java.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents Â© 2017 &lt;a href="mailto:wudong@graceliu.uk"&gt;Warren Liu&lt;/a&gt; </copyright><lastBuildDate>Mon, 17 Jul 2017 07:12:08 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Gradle In Action</title><link>https://wudong.graceliu.uk/posts/reading/gradle-in-action/</link><dc:creator>Warren Liu</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/reading/gradle-in-action/#sec-1"&gt;Getting started&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/reading/gradle-in-action/#sec-2"&gt;Using the command line&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/reading/gradle-in-action/#sec-3"&gt;Using the java plugin&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;Getting started&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;An hello world example:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="n"&gt;helloWorld&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;doLast&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;println&lt;/span&gt; &lt;span class="s1"&gt;'Hello world!'&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Execute the build script with &lt;code&gt;gradle -q helloWorld&lt;/code&gt;, the &lt;code&gt;-q&lt;/code&gt;
    tell Gradle only ouptut the task's output.
&lt;/li&gt;
&lt;li&gt;Tasks and actions are important elements of the language.
&lt;/li&gt;
&lt;li&gt;An &lt;code&gt;Action&lt;/code&gt; doLast specify it is the last action that's executed
for a task.
&lt;/li&gt;
&lt;li&gt;In a more concise way of same logic using &lt;code&gt;&amp;lt;&amp;lt;&lt;/code&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="n"&gt;helloWorld&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
   &lt;span class="n"&gt;println&lt;/span&gt; &lt;span class="s1"&gt;'Hello world!'&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Dynamic task definition and task chaining
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="n"&gt;startSession&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;chant&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;chant&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
   &lt;span class="n"&gt;ant&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;echo&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;message:&lt;/span&gt; &lt;span class="s1"&gt;'Repeat after me...'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;times&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
   &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="s2"&gt;"YayGradle$it"&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
      &lt;span class="n"&gt;println&lt;/span&gt; &lt;span class="s1"&gt;'Gradle rocks'&lt;/span&gt;
   &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;yayGradle0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;dependsOn&lt;/span&gt; &lt;span class="n"&gt;startSession&lt;/span&gt;
&lt;span class="n"&gt;yayGradle2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;dependsOn&lt;/span&gt; &lt;span class="n"&gt;yayGradle1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;yayGradle0&lt;/span&gt;

&lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="nf"&gt;groupTherapy&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;dependsOn:&lt;/span&gt; &lt;span class="n"&gt;yaygradle2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;task&lt;/code&gt; can be used to dynamically define tasks
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;dependsOn&lt;/code&gt; defines dependencies between tasks
&lt;/li&gt;
&lt;li&gt;Gradle is tight integrated with Ant. Every script is equipped with
a property call &lt;code&gt;ant&lt;/code&gt; that grants direct access to Ant tasks
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-2" class="outline-2"&gt;
&lt;h2 id="sec-2"&gt;Using the command line&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;list available tasks of a project: &lt;br&gt;
  &lt;code&gt;gradle -q tasks&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;list all available properties: &lt;br&gt;
  &lt;code&gt;gradle properties&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;task execution: can execute multiple tasks in a single build run &lt;br&gt;
  &lt;code&gt;gradle yayGradle0 groupTherapy&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;will execute the task &lt;code&gt;yayGradle0&lt;/code&gt; first then task &lt;code&gt;groupTherapy&lt;/code&gt; second.
&lt;/li&gt;
&lt;li&gt;Tasks are always executed just &lt;b&gt;once&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Gradle can abbreviate camel-cased task name on the command
line. So the command below is same as above &lt;br&gt;
    &lt;code&gt;gradle yG0 gT&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;However, the abbreviation has to be unique
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;exclude&lt;/b&gt; a task and its dependent tasks: &lt;br&gt;
  &lt;code&gt;gradle groupTherapy -x yayGradle0&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;specify a &lt;b&gt;build file&lt;/b&gt; with &lt;code&gt;-b, --build-file&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;build offline&lt;/b&gt; with &lt;code&gt;offline&lt;/code&gt; to only check the local dependency
cache for dependencies.
&lt;/li&gt;
&lt;li&gt;set property option:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;-D, --system-prop&lt;/code&gt; : set jvm system property
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-P, --project-prop&lt;/code&gt; : set project properties, which are variables
available in your build script.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;logging: &lt;code&gt;-i, --info&lt;/code&gt;, &lt;code&gt;-s --stacktrace&lt;/code&gt;, &lt;code&gt;-q, --quite&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;Gradle daemon: &lt;code&gt;--daemon&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;subsequent invocations of the &lt;code&gt;gradle&lt;/code&gt; command will now reuse the
daemon process.
&lt;/li&gt;
&lt;li&gt;The daemon process will automatically expire after a three-hour
idle time.
&lt;/li&gt;
&lt;li&gt;At any time you can choose to build without using the daemon with
&lt;code&gt;--no-daemon&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;To stop the daemon &lt;code&gt;gradle --stop&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-3" class="outline-2"&gt;
&lt;h2 id="sec-3"&gt;Using the java plugin&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Tell your project to use the Java plugin: &lt;br&gt;
  ~apply plugin: 'java'~
&lt;/li&gt;
&lt;li&gt;Using &lt;code&gt;build&lt;/code&gt; task to compile, run test and assembles the Jar.
&lt;/li&gt;
&lt;li&gt;
&lt;/li&gt;&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>gradle</category><category>java</category><guid>https://wudong.graceliu.uk/posts/reading/gradle-in-action/</guid><pubDate>Fri, 14 Jul 2017 23:00:00 GMT</pubDate></item><item><title>Spring Integration in Action</title><link>https://wudong.graceliu.uk/posts/reading/spring-integration-in-action/</link><dc:creator>Warren Liu</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/reading/spring-integration-in-action/#sec-1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/reading/spring-integration-in-action/#sec-2"&gt;Enterprise integration fundamentals&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/reading/spring-integration-in-action/#sec-3"&gt;Messages and Channels&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;Introduction&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Spring Integration consists of two parts:
&lt;ul class="org-ul"&gt;
&lt;li&gt;At its core, a &lt;i&gt;messaging framework&lt;/i&gt; that supports lightweight,
event-driven interactions &lt;b&gt;within&lt;/b&gt; an application.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The components in it would exist within the scope of a single
Spring application context.
&lt;/li&gt;
&lt;li&gt;They would exchange messages in a lightweight manner because
they are running in the same instance of a JVM.
&lt;/li&gt;
&lt;li&gt;No serialization is needed, most messages will contain POJO
instances as their payloads.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;On top of the core, an adapter-based platform that support
flexible integration of application across the enterprise.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Adapters are used to map the content from outbound messages into
the format that some external system expectes.
&lt;/li&gt;
&lt;li&gt;map inbound content from those external systems into messages.
&lt;/li&gt;
&lt;li&gt;In Spring Integration 2.0, following adapters are supported:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Filesystem, FTP, or SFTP
&lt;/li&gt;
&lt;li&gt;UDP, TCP
&lt;/li&gt;
&lt;li&gt;HTTP (REST)
&lt;/li&gt;
&lt;li&gt;Web services (SOAP)
&lt;/li&gt;
&lt;li&gt;Main (POP3, IMAP, SMTP)
&lt;/li&gt;
&lt;li&gt;Java Message Service (JMS)
&lt;/li&gt;
&lt;li&gt;Java Database Connectivity (JDBC)
&lt;/li&gt;
&lt;li&gt;Java Management Extension (JMX)
&lt;/li&gt;
&lt;li&gt;Remote Method Invocation (RMI)
&lt;/li&gt;
&lt;li&gt;Really Simple Syndication (RSS) feeds
&lt;/li&gt;
&lt;li&gt;Twitter
&lt;/li&gt;
&lt;li&gt;Extensible Messaging and Presence Protocol (XMPP)
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;In Spring Integration:
&lt;dl class="org-dl"&gt;
&lt;dt&gt; Channel Adapter &lt;/dt&gt;&lt;dd&gt;any unidirectional inbound &lt;b&gt;OR&lt;/b&gt; outbound adapter.
&lt;/dd&gt;
&lt;dt&gt; Messaging Gateway &lt;/dt&gt;&lt;dd&gt;bidirectional, or request-reply adapter.
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Message Channels
&lt;ul class="org-ul"&gt;
&lt;li&gt;Although the most important characteristic of any channel is that
it &lt;i&gt;logically&lt;/i&gt; decouples producers from consumers, there are a
number of &lt;i&gt;practical&lt;/i&gt; implementation options
&lt;ul class="org-ul"&gt;
&lt;li&gt;A channel implementation might dispatch messages directly to
&lt;b&gt;passive&lt;/b&gt; consumers within the &lt;i&gt;&lt;b&gt;same&lt;/b&gt; thread of control&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;A channel might buffer messages in a queue whose
reference is shared by producer and an &lt;b&gt;active&lt;/b&gt; consumer such
that the send and receive operations each occur within &lt;i&gt;&lt;b&gt;different&lt;/b&gt;
threads of control&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;Channels might be classified according to whether messages are
delivered to a single endpoint (point-to-point), or to any
endpoint that is listening to the channel (publish-subscribe).
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Channels can be categorized based on two dimension
&lt;ul class="org-ul"&gt;
&lt;li&gt;type of handoff : synchronous, or asynchronous
&lt;/li&gt;
&lt;li&gt;type of delivery
&lt;ul class="org-ul"&gt;
&lt;li&gt;Point-to-point
&lt;ul class="org-ul"&gt;
&lt;li&gt;Each single message is received by exactly &lt;b&gt;one&lt;/b&gt; consumer.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Competing Consumers&lt;/b&gt;: Multiple comsumers can compete for
messages from a single channel.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Publish-subscribe: delivers the same message to zero or more
subscribers.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The drawback of it is tha tthe sender isn't informed about
message delivery or failure to the same extent as in
point-to-point configurations.
&lt;/li&gt;
&lt;li&gt;Often require failure-handling patterns such as &lt;b&gt;Idempotent
Receiver&lt;/b&gt; or &lt;b&gt;Compensating Transactions&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Message Endpoints
&lt;ul class="org-ul"&gt;
&lt;li&gt;Channel Adapter
&lt;/li&gt;
&lt;li&gt;Message Gateway
&lt;/li&gt;
&lt;li id="Service Activator"&gt;is a component that invokes a service based
on an incoming message and sends an outbound message based on
the return value of this service invocation.
&lt;ul class="org-ul"&gt;
&lt;li&gt;In Spring Integration, it is constrained to local method calls.
&lt;/li&gt;
&lt;li&gt;Can be think of as a method-invoking outbound gateway.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li id="Router"&gt;determines the next channel a message should be send to
based on the incomming message.
&lt;/li&gt;
&lt;li id="Splitter"&gt;receives one message and splits it into multiple
messages that are send to its output channels.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Useful whenever the act of processing message content can be
split into multiple steps and executed by different consumers at
the same time.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li id="Aggregator"&gt;waits for a group of correlated messages and merges
them together when the group is completed.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The correlation of the messages typically is based on a
&lt;b&gt;correlation ID&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;A splitter and an aggregator are often used in a symmetric setup.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-2" class="outline-2"&gt;
&lt;h2 id="sec-2"&gt;Enterprise integration fundamentals&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Identifying highly coupled system
&lt;ul class="org-ul"&gt;
&lt;li&gt;One measure could be how many user types a class references. When
a class is referencing &lt;i&gt;many user types&lt;/i&gt;, it is considered &lt;span class="underline"&gt;highly coupled&lt;/span&gt;.
&lt;/li&gt;
&lt;li&gt;A general way of defining coupling is as a measure of how
connected the parts of a system are or how many assumptions the
components of the system make about each other.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Event-driven architecture
&lt;dl class="org-dl"&gt;
&lt;dt&gt; Staged event-driven architecture (SEDA) &lt;/dt&gt;&lt;dd&gt;events are communicated via
channels that can act as buffers in periods of high throughput.
&lt;ul class="org-ul"&gt;
&lt;li&gt;generally respond better to significant &lt;i&gt;spikes in load&lt;/i&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/li&gt;
&lt;li&gt;Synchronous and asynchronous communication
&lt;ul class="org-ul"&gt;
&lt;li&gt;In Spring Integration, simple configuration option allow you
switch between the two without channing the overall logical design
of the application.
&lt;/li&gt;
&lt;li&gt;With an increased load, the synchronous communication has few alternatives:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Trying to accomodate all requests as they arrive, which will
crash the system.
&lt;/li&gt;
&lt;li&gt;Throttling some of the requests to bring the load to a bearable level.
&lt;/li&gt;
&lt;li&gt;The application will eventually fail, when the load increases.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Unlike synchronous calls when the load of the system is controlled
by the &lt;b&gt;requesting side&lt;/b&gt;, in asynchronous model, the load of the
system is controllered by the &lt;b&gt;service provider's side&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Asynchronous communication has the obvious advantages in terms of
&lt;i&gt;scalabiity&lt;/i&gt; and &lt;i&gt;robustness&lt;/i&gt;, but it brings in &lt;b&gt;complexity&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;In Spring Integration, the two interaction model is determined by
the type of channel that is used for transferring the messages
between then endpoints
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;DirectChannel&lt;/b&gt; for synchronous
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;QueueChannel&lt;/b&gt; for asynchronous
&lt;/li&gt;
&lt;li&gt;The interaction model doesn't affect the logical design of the
system on how many channels, what endpoints, and how they are connected.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-3" class="outline-2"&gt;
&lt;h2 id="sec-3"&gt;Messages and Channels&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Three types of messages based on the role they fulfill:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Document messages that contain only information
&lt;/li&gt;
&lt;li&gt;Command messages that instruct the recipient to perform various operations
&lt;/li&gt;
&lt;li&gt;Event messages that indicate notable occurrences in the system and
to which the recipient may react.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The &lt;b&gt;Message&amp;lt;T&amp;gt;&lt;/b&gt; interface
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;Message&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;MessageHeaders&lt;/span&gt; &lt;span class="nf"&gt;getHeaders&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="nf"&gt;getPayload&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;It is rarely necessary to create your own message implementation,
apart from the build-ins with the framework.
&lt;/li&gt;
&lt;li&gt;The &lt;b&gt;MessageHeaders&lt;/b&gt; are &lt;b&gt;Map&lt;/b&gt; with some additional behaviour
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MessageHeaders&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;,&lt;/span&gt; &lt;span class="n"&gt;Serializable&lt;/span&gt; &lt;span class="o"&gt;{}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Message&lt;/b&gt; and &lt;b&gt;MessageHeaders&lt;/b&gt; are immutable objects, and can be
build with &lt;b&gt;MessageBuilder&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Channels aren't just information transfer components, they play an
&lt;b&gt;active&lt;/b&gt; role in defining the overall application behavior.
&lt;ul class="org-ul"&gt;
&lt;li&gt;different from other enterprise integration framework.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The &lt;b&gt;MessageChannel&lt;/b&gt; interface
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MessageChannel&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;send&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Message&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;send&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Msssage&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;To receiving message, two mechanism through which messages are
handed over to the next endpoint:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;SubscribableChannel extends MessageChannel&lt;/b&gt; interface
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;boolean subscribe(MessageHandler handler)&lt;/b&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;boolean unsubscribe(MessageHandler handler)&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;PollableChannel extends MessageChannel&lt;/b&gt; interface
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;Message&amp;lt;?&amp;gt; receive()&lt;/b&gt;;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Message&amp;lt;?&amp;gt; receive(long timeout)&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Spring Integration offers a number of channel implements. The type
of channel you select has significant implications for your
application, including
&lt;ul class="org-ul"&gt;
&lt;li&gt;transactional boundaries,
&lt;/li&gt;
&lt;li&gt;lagency
&lt;/li&gt;
&lt;li&gt;overall throughput
&lt;/li&gt;
&lt;li&gt;The default channel used is &lt;b&gt;SubscribableChannel&lt;/b&gt;, and the message
transmission is synchronous.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Type of channels:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;QueueChannel&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;PriorityChannel&lt;/b&gt; with a priority queue.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;PUblishSubscribeChannel&lt;/b&gt; for more than one consumer.
&lt;ul class="org-ul"&gt;
&lt;li&gt;It doesn't support queueing,
&lt;/li&gt;
&lt;li&gt;but does support asynchronous operation if provided with a task
executor that delivers messages to each of the subscribers in
separate threads.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;bridge&lt;/b&gt; is an enterprise integration pattern that supports the
connection of two channels.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Channel collaborators:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;MessageDispatcher&lt;/b&gt; controls how messages sent to a channel are
passed to any registered handlers.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ChannelInterceptor&lt;/b&gt; allows interception at key points like
channel send and receive operations
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>java</category><category>spring</category><guid>https://wudong.graceliu.uk/posts/reading/spring-integration-in-action/</guid><pubDate>Fri, 14 Jul 2017 23:00:00 GMT</pubDate></item><item><title>Java 8 Topics</title><link>https://wudong.graceliu.uk/posts/notes/java-8-topics/</link><dc:creator>Warren Liu</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-1"&gt;NIO File API&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-1-0-1"&gt;&lt;span class="todo TODO"&gt;TODO&lt;/span&gt; more on the File API.&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-2"&gt;Using Method References&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-3"&gt;Collection and Stream&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-3-1"&gt;Some of the JDK libraries that return a Stream&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-3-2"&gt;Reducing a Collection to a single value.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-3-3"&gt;Collectors&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-4"&gt;Multiple and Fluent Comparisons&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-4-1"&gt;Decorator pattern with Lambda&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-5"&gt;Automatic Resource Management (ARM)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-6"&gt;Dealing with Exceptions in Lambda&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-7"&gt;Lambda with Laziness&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-7-1"&gt;Delayed Initialization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-7-2"&gt;Creating Infinite, Lazy Collections&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-8"&gt;Default methods&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-8-1"&gt;Interface Evolution&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-8-topics/#sec-8-2"&gt;Inheritance and Class-Building&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;NIO File API&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;java.nio.file.Path&lt;/code&gt; is part of the more modern &lt;code&gt;java.nio.file&lt;/code&gt; lib
and does everything &lt;code&gt;java.io.File&lt;/code&gt; can, but generally in a better way.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;path.toFile()&lt;/code&gt; to convert to &lt;code&gt;File&lt;/code&gt; for legacy.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;file.ToPath()&lt;/code&gt; to convert to &lt;code&gt;Path&lt;/code&gt; instance.
&lt;/li&gt;
&lt;li&gt;Using &lt;code&gt;Files&lt;/code&gt; utility class, which deals with &lt;code&gt;Path&lt;/code&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt; &lt;span class="n"&gt;fp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toPath&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="n"&gt;Files&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;delete&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Problems with &lt;code&gt;java.io.File&lt;/code&gt;:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Many methods didn't throw exceptions when they failed, so it was
impossible to obtain a useful error message.
&lt;/li&gt;
&lt;li&gt;No real support for symbolic links.
&lt;/li&gt;
&lt;li&gt;More support for metadata was desired.
&lt;/li&gt;
&lt;li&gt;Many of the &lt;code&gt;File&lt;/code&gt; method didn't scale. Requesting a large
directory listing over a server would result in a hang.
&lt;/li&gt;
&lt;li&gt;No possible to write reliable code that could recursively walk a
file tree when there were circular symbolic link.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Creating a Path
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;Paths.get(String... filePath)&lt;/code&gt;, which is a shorthand for:
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FileSystems.getDefault().getPath(String filePath)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;Example:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Paths&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getProperty&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"user.home"&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="s"&gt;"logs"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"foo.log"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Files&lt;/code&gt; consists exclusively of static methods that operate on
files, directories or other types of files. In most cases, these
methods will delegate to the associated &lt;code&gt;file system provider&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;copy:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;copy(InputStream in, Path target, CopyOption...options)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;copy(Path source, OutputStream out)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;copy(Path source, Path target target, CopyOption... options)&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;create:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;createDirectoreis(Path dir, FileAttribute... attrs)&lt;/code&gt; : will
create nonexistent parent directories first.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;createDirectory(Path dir, FileAttribute... attrs)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;createFile(Path path)&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-1-0-1" class="outline-4"&gt;
&lt;h4 id="sec-1-0-1"&gt;&lt;span class="todo TODO"&gt;TODO&lt;/span&gt; more on the File API.&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-2" class="outline-2"&gt;
&lt;h2 id="sec-2"&gt;Using Method References&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Java compiler will take either a lambda expression, or a reference
to a method, where an implementation of a &lt;b&gt;function interface&lt;/b&gt; is
expected.
&lt;/li&gt;
&lt;li&gt;Method reference is used to &lt;b&gt;replace a single-method lambda
expression&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Method reference for static methods and methods take parameters:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;staticMethod&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arg2&lt;/span&gt;&lt;span class="o"&gt;)-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;staticMethod&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arg2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;//equals to&lt;/span&gt;
&lt;span class="nl"&gt;Class:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;staticMethod&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Any arguments, if any, taken by the method are passed automatically.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Numbers&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;isMoreThanFifty&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n2&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;n2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;findNumbers&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
	   &lt;span class="n"&gt;BiPredicate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
	&lt;span class="o"&gt;...&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// Using a lambda expression&lt;/span&gt;
&lt;span class="n"&gt;findNumbers&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Numbers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isMoreThanFifty&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i2&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;span class="c1"&gt;// Using a method reference&lt;/span&gt;
&lt;span class="n"&gt;findNumbers&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Numbers&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;isMoreThanFifty&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Instance method reference of an object of a particular type
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;instanceMethod&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;//equals to&lt;/span&gt;
&lt;span class="nl"&gt;ObjectType:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;instanceMethod&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;For example:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;TriFunction&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;U&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;R&lt;/span&gt; &lt;span class="nf"&gt;apply&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;U&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Sum&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;Integer&lt;/span&gt; &lt;span class="nf"&gt;doSum&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;s1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;s2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;parseInt&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s1&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;parseInt&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s1&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;//using lambda&lt;/span&gt;
&lt;span class="n"&gt;TriFunction&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Sum&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;lambda&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
    &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Sum&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;arg1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;arg2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;doSum&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arg1&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="c1"&gt;//Using method reference&lt;/span&gt;
&lt;span class="n"&gt;TriFunction&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Sum&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mRef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sum&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;doSum&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Instance method reference of an existing object.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;instanceMethod&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;//equals to&lt;/span&gt;
&lt;span class="nl"&gt;obj:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;instanceMethod&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Constructor method reference
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ClassName&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;//equals to&lt;/span&gt;
&lt;span class="nl"&gt;ClassName:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-3" class="outline-2"&gt;
&lt;h2 id="sec-3"&gt;Collection and Stream&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;With &lt;code&gt;forEach&lt;/code&gt;, once the method starts, we can't break out of the
iteration.
&lt;/li&gt;
&lt;li&gt;Pick one element with &lt;code&gt;findFirst/findAny&lt;/code&gt; which return an &lt;code&gt;Optional&lt;/code&gt;.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Optinal&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;foundName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
    &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;startsWith&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;letter&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findFirst&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="n"&gt;foundName&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ifPresnet&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"hello"&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-3-1" class="outline-3"&gt;
&lt;h3 id="sec-3-1"&gt;Some of the JDK libraries that return a Stream&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-3-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;Stream.concat()&lt;/code&gt; lazily concatenated streams
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Stream.generate(Supplier&amp;lt;T&amp;gt; s)&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Get a &lt;code&gt;Stream&lt;/code&gt; from &lt;code&gt;Iterator&lt;/code&gt;:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Stream&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;iteratorToStream&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Iterator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;iterator&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
   &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Stream&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;generate&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iterator&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Stream.iterate(T seed, UnaryOperator&amp;lt;T&amp;gt; f)&lt;/code&gt;: return a Stream
consisting of &lt;code&gt;seed&lt;/code&gt;, &lt;code&gt;f(seed)&lt;/code&gt;, &lt;code&gt;f(f(seed))&lt;/code&gt;, etc.
&lt;/li&gt;
&lt;li&gt;
&lt;/li&gt;&lt;li&gt;&lt;code&gt;chars()&lt;/code&gt; method from the &lt;code&gt;CharSequence&lt;/code&gt; interface, returns a
Stream&amp;lt;Int&amp;gt; over which we can iterate.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;chars&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;forEach&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.::&lt;/span&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Stream&amp;lt;Path&amp;gt; Files.list(Path path)&lt;/code&gt; method list all filenames in a
directory, or &lt;code&gt;listFiles()&lt;/code&gt; to get all the files instead of just
their names.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Files&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;list&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Paths&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
     &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Files&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;isDirectory&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
     &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forEach&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Stream&amp;lt;String&amp;gt; Files.lines(Path path)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Stream&amp;lt;Path&amp;gt; Files.find(Path start, int maxDepth, BiPredicate&amp;lt;Path,
  BasicFileAttributes&amp;gt; matchers, FileVisitOption... options)&lt;/code&gt; :
Returns a Stream that is lazily populated with Path by searching for
files in a file tree rooted at a given starting file.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-3-2" class="outline-3"&gt;
&lt;h3 id="sec-3-2"&gt;Reducing a Collection to a single value.&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-3-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Similar method on &lt;code&gt;Stream&lt;/code&gt; are : &lt;code&gt;max&lt;/code&gt;, &lt;code&gt;min&lt;/code&gt;,  &lt;code&gt;average&lt;/code&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;mapToInt&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;()).&lt;/span&gt;&lt;span class="na"&gt;sum&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Optional&amp;lt;T&amp;gt; reduce(BinaryOperator&amp;lt;T&amp;gt; accumulator)&lt;/code&gt; : reduction
using an associated accumulation function. This is equivalent to:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="n"&gt;foundAny&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(!&lt;/span&gt;&lt;span class="n"&gt;foundAny&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
	&lt;span class="n"&gt;foundAny&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;accumulator&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;apply&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;foundAny&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;Optional&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;of&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Optional&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;emtpy&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;But it is &lt;i&gt;&lt;b&gt;not&lt;/b&gt; constrained to execute sequentially&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;empty stream results in Optional.empty()
&lt;/li&gt;
&lt;li&gt;Single element stream result in the element returned, without
apply the accumulator.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;T reduce(T identity, BinaryOperator&amp;lt;T&amp;gt; accumulator)&lt;/code&gt; : is
equivalent to:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;identity&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;accumulator&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;apply&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The &lt;code&gt;identity&lt;/code&gt; value must be an identity for the accumulator
function, this means that for all &lt;code&gt;t&lt;/code&gt;,
&lt;code&gt;accumulator.apply(identity, t)&lt;/code&gt; is equal to &lt;code&gt;t&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;accumulator&lt;/code&gt; function must be an associative function:
&lt;ul class="org-ul"&gt;
&lt;li&gt;which means:
&lt;p class="verse"&gt;
(a op b) op c == a op (b op c)&lt;br&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;Associative function is important for parallel evaluation:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;U reduce(U identity, BiFunction&amp;lt;U, T, U&amp;gt; accumulator,
  BinaryOperator&amp;lt;U&amp;gt; combiner)&lt;/code&gt;: The most general form of reduce.
&lt;/li&gt;
&lt;li&gt;Using &lt;code&gt;StringJoiner&lt;/code&gt; class or the convenience method
&lt;code&gt;String.join()&lt;/code&gt; to join collection into a string.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;join&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;", "&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;collect()&lt;/code&gt; method does the reduction but delegate the actual
implementation or target to collector.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;toUpperCase&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;collect&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;joining&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;", "&lt;/span&gt;&lt;span class="o"&gt;)));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-3-3" class="outline-3"&gt;
&lt;h3 id="sec-3-3"&gt;Collectors&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-3-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;Stream.collect()&lt;/code&gt; method takes a &lt;code&gt;Collector&lt;/code&gt;, or three functions
with a signature like:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;collect(Supplier&amp;lt;R&amp;gt; supllier, BiConsumer&amp;lt;R,T&amp;gt; accumulator,
    BiConsumer&amp;lt;R, R&amp;gt; combiner)&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;make the result container,
&lt;/li&gt;
&lt;li&gt;add a single elements to a result container,
&lt;/li&gt;
&lt;li&gt;merge one result container into another.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Example:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;olderThan20&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
    &lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;collect&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;addAll&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;Collector&amp;lt;T, A, R&amp;gt;&lt;/code&gt; interface wraps the three parameters list above,
with an optional additional finisher for final transform on the
container.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;T&lt;/code&gt; The type of stream elements.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;A&lt;/code&gt; The mutable accumulation type of the reduction operation.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;R&lt;/code&gt; The result type of the reduction operation.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;Collector&lt;/code&gt; could have a list of &lt;code&gt;Characteristics&lt;/code&gt; for inspect:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;CONCURRENt&lt;/code&gt; : indicate the result container can support the
accumulator function being called concurrently with same result container.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IDENTITY_FINISH&lt;/code&gt; : finisher function is the &lt;i&gt;identity function&lt;/i&gt;
    and can be ignored.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;UNORDERED&lt;/code&gt; : the collection operation doesn't commit to
preserving the encounter order of input elements.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Collectors&lt;/code&gt; provides many useful &lt;code&gt;Collector&lt;/code&gt; for reduction
operations.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;summarizingDouble(ToDoubleFunction mapper)&lt;/code&gt; : Return summary
statistics for the resulting double values from the mapper.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DoubleSummaryStatistics&lt;/code&gt; have method to get &lt;code&gt;average&lt;/code&gt;, &lt;code&gt;count&lt;/code&gt;,
&lt;code&gt;max&lt;/code&gt;, &lt;code&gt;min&lt;/code&gt;, &lt;code&gt;sum&lt;/code&gt; for the collection.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;averagingDouble(ToDobuleFunction mapper)&lt;/code&gt; : produce the arithmetic
mean of a double-valued function applied to the input elements.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;averagingInt&lt;/code&gt;, &lt;code&gt;averagingLong&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;counting()&lt;/code&gt; : counts the number of input elements.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;groupingBy(Function&amp;lt;T, K&amp;gt; classifier)&lt;/code&gt;: grouping elements according
to a classification function. and return a Map.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;groupingByConcurrent()&lt;/code&gt; returns a concurrent Collector.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mapping(Function&amp;lt;T, U&amp;gt; mapper, Collector downstream)&lt;/code&gt; : applying
the mapping to each input element before accumulation. It adapts a
Collector accepting elements of type &lt;code&gt;U&lt;/code&gt; to one accepting &lt;code&gt;T&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;partioningBy(Predicate&amp;lt;T&amp;gt; predicate)&lt;/code&gt; : collector that return a
&lt;code&gt;Map&amp;lt;Boolean, List&amp;lt;T&amp;gt;&amp;gt;&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;reducing(BinaryOperator&amp;lt;T&amp;gt; op)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;toMap&lt;/code&gt;, &lt;code&gt;toConcurrentMap(Function&amp;lt;&amp;gt; keyMapper, Function&amp;lt;&amp;gt;
  valueMapper)&lt;/code&gt; : return a &lt;code&gt;ConcurrentMap&lt;/code&gt;, whose keys and values are
mapped from each elements.
&lt;/li&gt;
&lt;li&gt;If the mapped keys contains duplicates, &lt;code&gt;IllegalStateException&lt;/code&gt;
  is thrown.
&lt;ul class="org-ul"&gt;
&lt;li&gt;It is common for either the key or the value to be the input
elements. In this case, the utility method &lt;code&gt;Function.identity()&lt;/code&gt;
may be helpful:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Student&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Double&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;studentToGPA&lt;/span&gt;
&lt;span class="n"&gt;students&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;collect&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toMap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Functions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;identity&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt;
			       &lt;span class="n"&gt;student&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;computeGPA&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;student&lt;/span&gt;&lt;span class="o"&gt;)));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;toMap(Function keyMapper, Function valueMapper, BinaryOperator
  mergeFunction)&lt;/code&gt;: takes an additional merge function, when the maps
key contains duplicates, the corresponding values is merged by it.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-4" class="outline-2"&gt;
&lt;h2 id="sec-4"&gt;Multiple and Fluent Comparisons&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-4"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;List.sort()&lt;/code&gt; mutate the list, to preserve the original list using
the Stream's &lt;code&gt;sorted()&lt;/code&gt; method:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ascendingAge&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;sorted&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
   &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;person2&lt;/span&gt;&lt;span class="o"&gt;)-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;person1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ageDifference&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person2&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;collect&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toList&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
&lt;span class="c1"&gt;// or we could do with method references.&lt;/span&gt;
&lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;sorted&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ageDifference&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;If all we want is a reverse of the comparison, the &lt;code&gt;Comparator&lt;/code&gt;
  method has a &lt;code&gt;reversed()&lt;/code&gt; default method:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Comparator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;compareAscending&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;person2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;person1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ageDifference&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person2&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;Comparator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;compareDescending&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;compareAscending&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;reversed&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;min/max&lt;/code&gt; method could also take a comparator:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;min&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ageDifference&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;ifPresent&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
  &lt;span class="n"&gt;youngest&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Youngest: "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;youngest&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;static Comparator&amp;lt;T&amp;gt; comparing(Function&amp;lt;T, U&amp;gt; keyExtractor&amp;gt;)&lt;/code&gt;:
allowing comparing by some key:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Function&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;byName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;sorted&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;comparing&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;byName&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;With multiple comparators,  using &lt;code&gt;thenComparing()&lt;/code&gt;:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Function&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;byAge&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Function&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;byName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;sorted&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;comparing&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;byAge&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;thenComparing&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;byName&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-4-1" class="outline-3"&gt;
&lt;h3 id="sec-4-1"&gt;Decorator pattern with Lambda&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-4-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Using the &lt;code&gt;Function.andThen()&lt;/code&gt; to combine or chain two &lt;code&gt;Function&lt;/code&gt;
  together.
&lt;/li&gt;
&lt;li&gt;Once we compose them, a call to &lt;code&gt;apply()&lt;/code&gt; will hop through the
chained ~Function~s:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;wrapper&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;andThen&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;wrapper&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;apply&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="c1"&gt;//same as&lt;/span&gt;
&lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;apply&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;apply&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;An example for decorator pattern:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;setFilters&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Function&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;...&lt;/span&gt; &lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;filters&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Arrays&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;asList&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
	&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;reduce&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="o"&gt;)-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compose&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
	&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;orElse&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Function&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;identity&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-5" class="outline-2"&gt;
&lt;h2 id="sec-5"&gt;Automatic Resource Management (ARM)&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-5"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Rather than using both the &lt;code&gt;try&lt;/code&gt; and &lt;code&gt;finally&lt;/code&gt; blocks, a special
form of the &lt;code&gt;try&lt;/code&gt; block with a resource attached to it.
&lt;/li&gt;
&lt;li&gt;The java compiler will automatically inserting the finally block and
then call the &lt;code&gt;close()&lt;/code&gt; method:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;FilrWriterARM&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;AutoCloseable&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="o"&gt;...&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;close&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;IOException&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"close called automatically..."&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;close&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;FileWriterARM&lt;/span&gt; &lt;span class="n"&gt;writerARM&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;FileWriterARM&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"somefile"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
   &lt;span class="o"&gt;}{&lt;/span&gt;
    &lt;span class="n"&gt;writerARM&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;write&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"somsthing"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Done with the resources..."&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;We can see the &lt;code&gt;close()&lt;/code&gt; method was called as soon as we left the try
block.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Could also use lambda expressions and the &lt;b&gt;execute around method&lt;/b&gt;
  pattern to manage resources:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;use&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;fileName&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
		       &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;UseInstance&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;FileWriterARM&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IOException&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;FileWriterARM&lt;/span&gt; &lt;span class="n"&gt;writerARM&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;FileWriterARM&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;accept&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;writerARM&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="n"&gt;writerARM&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;close&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-6" class="outline-2"&gt;
&lt;h2 id="sec-6"&gt;Dealing with Exceptions in Lambda&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-6"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The &lt;code&gt;apply()&lt;/code&gt; method of the &lt;code&gt;Function&lt;/code&gt; interface does not specify
any checked exceptions.
&lt;/li&gt;
&lt;li&gt;So the lambda expression is not permitted to throw any checked exceptions.
&lt;/li&gt;
&lt;li&gt;Two options:
&lt;ul class="org-ul"&gt;
&lt;li&gt;handle the exception within the lambda expression, or
&lt;/li&gt;
&lt;li&gt;catch and rethrow it as an unchecked exception.
&lt;ul class="org-ul"&gt;
&lt;li&gt;In a concurrent execution, an exception raised within the lambda
expression will be propagated automatically to the calling
primary thread.
&lt;/li&gt;
&lt;li&gt;This will not terminate or obstruct the execution of other
lambda expressions running concurrently.
&lt;/li&gt;
&lt;li&gt;If exceptions are thrown from multiple concurrent executions,
only &lt;i&gt;one of them will be reported in the catch block&lt;/i&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;If the details of all exceptions are important, it is better to
capture those within the lambda expressions and pass them back to
the main thread as part of the result.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;When we design our own higher-order functions based on our specific
need, we can more flexibly design the companion functional
interfaces to go with it.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nd"&gt;@FunctionalInterface&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;UseInstance&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;Throwable&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;accept&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-7" class="outline-2"&gt;
&lt;h2 id="sec-7"&gt;Lambda with Laziness&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-7"&gt;
&lt;/div&gt;&lt;div id="outline-container-sec-7-1" class="outline-3"&gt;
&lt;h3 id="sec-7-1"&gt;Delayed Initialization&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-7-1"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Holder&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;Supplier&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Heavy&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;heavy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;createAndCacheHeavy&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;Holder&lt;/span&gt;&lt;span class="o"&gt;(){&lt;/span&gt;
	&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;outpr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Heavy Holder is created"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Heavy&lt;/span&gt; &lt;span class="nf"&gt;getHeavy&lt;/span&gt;&lt;span class="o"&gt;(){&lt;/span&gt;
	&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;heavy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;synchronized&lt;/span&gt; &lt;span class="nf"&gt;createAndCacheHeavy&lt;/span&gt;&lt;span class="o"&gt;(){&lt;/span&gt;
	&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HeavyFactory&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Supplier&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Heavy&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Heavy&lt;/span&gt; &lt;span class="n"&gt;heavyInstance&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Heavy&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Heavy&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
		&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;heavyInstance&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	    &lt;span class="o"&gt;}&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;

	&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(!&lt;/span&gt;&lt;span class="n"&gt;HeavyFactory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isInstance&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;heavy&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;heavy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HeavyFactory&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;

	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;heavy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The above use an indirect &lt;code&gt;Supplier&lt;/code&gt; to avoid synchronization on all
the &lt;code&gt;get()&lt;/code&gt; which normally required when using a plain &lt;code&gt;null&lt;/code&gt; check
and lazy initialization pattern.
&lt;/li&gt;
&lt;li&gt;Only the first call to &lt;code&gt;heavy.get()&lt;/code&gt; is synchronized, the later ones
are not because the &lt;code&gt;heavy&lt;/code&gt; instance has been changed by the first
call.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-7-2" class="outline-3"&gt;
&lt;h3 id="sec-7-2"&gt;Creating Infinite, Lazy Collections&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-7-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Using Stream's &lt;code&gt;static iterate(seed, UnaryOperator)&lt;/code&gt; method.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-8" class="outline-2"&gt;
&lt;h2 id="sec-8"&gt;Default methods&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-8"&gt;
&lt;p&gt;
&lt;i&gt;- https://blog.codefx.org/java/everything-about-default-methods/&lt;/i&gt;
&lt;/p&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Syntax: just like a regular method but modified with &lt;code&gt;default&lt;/code&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="n"&gt;Comparator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;thenComparing&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Comparator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&lt;/span&gt; &lt;span class="kd"&gt;super&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;o1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;o2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compare&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;o1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;o2&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compare&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;o1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;o2&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Explicit call to Default Methods:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;StringComparator&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Comparator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;//...&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Comparator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;thenComparing&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Comparator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&lt;/span&gt; &lt;span class="kd"&gt;super&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"call to super"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Comparator&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;super&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;thenComparing&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The interface name is used to specify the following &lt;code&gt;super&lt;/code&gt; which
would otherwise refer to the superclass (in this case Object).
&lt;/li&gt;
&lt;li&gt;It is not possbile to call a method from an interface that is not
mentioned in the &lt;code&gt;implements&lt;/code&gt; clause.
&lt;/li&gt;
&lt;li&gt;When implementing two interfaces where &lt;i&gt;one extends the other&lt;/i&gt;
    &lt;b&gt;Comparator.super&lt;/b&gt; causes a different compile error.
&lt;/li&gt;
&lt;li&gt;Together this means that it is &lt;i&gt;not possible to explicitly call
&lt;b&gt;overridden&lt;/b&gt; or &lt;b&gt;reabstracted&lt;/b&gt; default methods&lt;/i&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Resolution Strategy:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Classes win over interfaces.
&lt;/li&gt;
&lt;li&gt;More specific interfaces win over less specific ones. A default
from &lt;code&gt;List&lt;/code&gt; wins over a default from &lt;code&gt;Collection&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;If there is not a unique winner according to the above rules,
concrete classes must disambiguate manually.
&lt;/li&gt;
&lt;li&gt;Re-Abstracing methods:
&lt;ul class="org-ul"&gt;
&lt;li&gt;If an abstract class or interface declares a method as
&lt;i&gt;abstract&lt;/i&gt; for which a &lt;i&gt;default implementation exists&lt;/i&gt; in some
superinterface, the default implementation of is overridden.
&lt;/li&gt;
&lt;li&gt;Hence all concrete classes which subtype it must implement the
method.
&lt;/li&gt;
&lt;li&gt;This technique is used throughout the JDK, e.g. on ConcurrentMap
(link) which re-abstracts a number of methods for which Map
(link) provides default implementations because these are not
thread-safe.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;It is not possible for an interface to provide default
implementations for the methods in Object.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Default methods can only be &lt;code&gt;public&lt;/code&gt;, and cannot be &lt;code&gt;final&lt;/code&gt; or
&lt;code&gt;synchronized&lt;/code&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-8-1" class="outline-3"&gt;
&lt;h3 id="sec-8-1"&gt;Interface Evolution&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-8-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The purpose of default method is to enable interfaces to be evolved
in a compatible manner after their initial publication.
&lt;ul class="org-ul"&gt;
&lt;li&gt;It was impossible to add methods to interfaces without breaking
all implementations before default method.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Ousting Utility classes. All those static methods which take an
instance of the interfaces as an argument can now be transformed
into a default method on the interface.
&lt;ul class="org-ul"&gt;
&lt;li&gt;While removing all interface-related utility classes in a code
base is possible,
&lt;/li&gt;
&lt;li&gt;It &lt;b&gt;might not be advisable&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;The usability and cohesiveness of the interface should remain the
main priority.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-8-2" class="outline-3"&gt;
&lt;h3 id="sec-8-2"&gt;Inheritance and Class-Building&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-8-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;With inheritance a type can assume three types of characteristics of
another type:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Type
&lt;/li&gt;
&lt;li&gt;Behaviour
&lt;/li&gt;
&lt;li&gt;State
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Class subtyping inherit all three of those characteristics.
&lt;/li&gt;
&lt;li&gt;Interface with default methods subtyping inherit only Type and
Behaviour.
&lt;/li&gt;
&lt;li&gt;Default method vs Mixin and Traits
&lt;ul class="org-ul"&gt;
&lt;li&gt;Mixin allow to inherit their type, behaviour &lt;b&gt;and state&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;As interfaces with defaults allow no inheritance of state, they
are clearly not mixins.
&lt;/li&gt;
&lt;li&gt;Traits do not define their own state, very similar to interfaces
with default methods
&lt;/li&gt;
&lt;li&gt;But the concepts are still different, and those differences are
not entirely trivial.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Default methods vs Abstract classes
&lt;ul class="org-ul"&gt;
&lt;li&gt;Language Differences
&lt;ul class="org-ul"&gt;
&lt;li&gt;Interfaces allow multiple inheritance
&lt;/li&gt;
&lt;li&gt;Default methos are never final, cannot be synchronized and
cannot override &lt;code&gt;Object&lt;/code&gt;'s method and always public.
&lt;/li&gt;
&lt;li&gt;Cannot define fields, so every state change has to be done via
the public API.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Conceptual Differences
&lt;ul class="org-ul"&gt;
&lt;li&gt;Classes define &lt;i&gt;what something is&lt;/i&gt;, while interfaces usually
define &lt;i&gt;what something can do&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;Abstract classes are valid for skeletal (i.e. partial)
implementations of interfaces but &lt;i&gt;should not exist without a
matching interface&lt;/i&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>java</category><guid>https://wudong.graceliu.uk/posts/notes/java-8-topics/</guid><pubDate>Thu, 13 Jul 2017 23:00:00 GMT</pubDate></item><item><title>Java Concurrency</title><link>https://wudong.graceliu.uk/posts/notes/java-concurrency/</link><dc:creator>Warren Liu</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1"&gt;Java Thread/Concurrency&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-1"&gt;Thread&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-2"&gt;Synchronization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-3"&gt;Waiting and Notification&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-4"&gt;Concurrency Utilities and Executors&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-5"&gt;Synchronizers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-6"&gt;The Locking Framework&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-7"&gt;LockSupport&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-8"&gt;Concurrent Collections&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-9"&gt;Atomic Variables&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-10"&gt;Fork/Join&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-11"&gt;CompletionService&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-concurrency/#sec-1-12"&gt;Testing Concurrent Applications&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;



&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;Java Thread/Concurrency&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;/div&gt;&lt;div id="outline-container-sec-1-1" class="outline-3"&gt;
&lt;h3 id="sec-1-1"&gt;Thread&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Thread's &lt;b&gt;Execution State&lt;/b&gt; with the &lt;code&gt;Thread.getState()&lt;/code&gt; method
returns &lt;code&gt;Enum Thread.State&lt;/code&gt;:
&lt;dl class="org-dl"&gt;
&lt;dt&gt; NEW &lt;/dt&gt;&lt;dd&gt;not yet started
&lt;/dd&gt;
&lt;dt&gt; RUNNABLE &lt;/dt&gt;&lt;dd&gt;executing
&lt;/dd&gt;
&lt;dt&gt; BLOCKED &lt;/dt&gt;&lt;dd&gt;A thread that is blocked &lt;b&gt;waiting for a monitor locks&lt;/b&gt;
&lt;/dd&gt;
&lt;dt&gt; WAITING &lt;/dt&gt;&lt;dd&gt;waiting &lt;b&gt;indefinitely&lt;/b&gt; for another thread to perform a
particular action. A thread is in this state due to
calling one of the following methods:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;Object.wait()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Thread.join()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LockSupport.park()&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; TIMED&lt;sub&gt;WAITING&lt;/sub&gt; &lt;/dt&gt;&lt;dd&gt;waiting with a specified waiting time.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Apart from the timeout version of the above methods,
&lt;code&gt;Thread.sleep()&lt;/code&gt; also put thread into this state.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; TERMINATED &lt;/dt&gt;&lt;dd&gt;exited
&lt;/dd&gt;
&lt;dt&gt; (no term) &lt;/dt&gt;&lt;dd&gt;Notice the difference between &lt;b&gt;BLOCKED&lt;/b&gt; and &lt;b&gt;WAITING&lt;/b&gt;.
&lt;/dd&gt;
&lt;dt&gt; (no term) &lt;/dt&gt;&lt;dd&gt;Differenct WAITING status:
&lt;ul class="org-ul"&gt;
&lt;li&gt;STATE: &lt;b&gt;BLOCKED (on object monitor)&lt;/b&gt; : waiting for monitor entry,
when using intrinsicLock, i.e., the &lt;code&gt;synchronized&lt;/code&gt; keyword.
&lt;/li&gt;
&lt;li&gt;STATE: &lt;b&gt;WAITING (parking)&lt;/b&gt;: waiting on condition, when using locks
from &lt;code&gt;java.util.concurrent&lt;/code&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/li&gt;

&lt;li&gt;Thread's priority is taken into consideration by OS's Scheduler.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;void setPriority(int priority)&lt;/code&gt; : take value between
&lt;b&gt;Thread.MIN&lt;sub&gt;PRIORITY&lt;/sub&gt;&lt;/b&gt; and &lt;b&gt;Thread.MAX&lt;sub&gt;PRIORITY&lt;/sub&gt;&lt;/b&gt;, and
Thread.NORMAL&lt;sub&gt;PRIORITY&lt;/sub&gt;* identifies the default priority.
&lt;/li&gt;
&lt;li&gt;On Linux, the default scheduler is &lt;b&gt;Completely Fair Scheduler&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;References:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;a href="https://en.wikipedia.org/wiki/Completely_Fair_Scheduler"&gt;https://en.wikipedia.org/wiki/Completely_Fair_Scheduler&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.informit.com/articles/article.aspx?p=101760"&gt;http://www.informit.com/articles/article.aspx?p=101760&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.linuxjournal.com/magazine/completely-fair-scheduler"&gt;http://www.linuxjournal.com/magazine/completely-fair-scheduler&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Use a &lt;b&gt;red-black tree&lt;/b&gt; (self balanced binary tree) to sort process
according to its &lt;b&gt;execution time&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Process with lowest execution time is scheduled next to run.
&lt;/li&gt;
&lt;li&gt;Process running exceeding the max execution time is reinserted
into the tree for further scheduling.
&lt;/li&gt;
&lt;li&gt;If a process spends a lot of its time sleeping, then its spent
time value is low and it automatically gets the priority boost
when it finally needs it
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;On Windows, it is &lt;b&gt;multilevel feedback queue scheduler&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;A &lt;b&gt;daemon thread&lt;/b&gt; is a thread that acts as a helper to &lt;b&gt;nondaemon
thread&lt;/b&gt; and &lt;b&gt;dies&lt;/b&gt; automatically when the application's last
nondaemon thread dies so that the application can terminate.
&lt;/li&gt;
&lt;li&gt;Application will not terminate when the nondaemon default main
thread terminates until all background nondaemon threads
terminate.
&lt;/li&gt;
&lt;li&gt;Interrupting Threads
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;void interrupt()&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;If this thread is &lt;b&gt;blocked&lt;/b&gt; because a call to &lt;code&gt;wait()&lt;/code&gt;, &lt;code&gt;sleep()&lt;/code&gt;
or &lt;code&gt;join()&lt;/code&gt; methods, the thread's &lt;b&gt;interrupted status&lt;/b&gt; is
cleared and &lt;b&gt;InterruptedException&lt;/b&gt; is thrown.
&lt;/li&gt;
&lt;li&gt;If this thread is &lt;b&gt;blocked&lt;/b&gt; in an I/O operation on an
&lt;b&gt;interruptible channel&lt;/b&gt;, the channel will be closed, the
interrupt status will be set and the thread will receive a
&lt;b&gt;ClosedByInterruptException&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;If the thread is blocked in a &lt;b&gt;Selector&lt;/b&gt;, then the interrupt
status will be set and it will return immediately from the
selection operation. possilby with a non-zero value.
&lt;/li&gt;
&lt;li&gt;Otherwise the interrupt status is set.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;static boolean interrupted()&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Test whether the &lt;b&gt;current&lt;/b&gt; thread has been interrupted. The
interrupted status of the thread is cleard by this method.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;boolean isInterrupted()&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Test whether this thread has been interrupted. The interrupted
status of the thread is unaffected by this method.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Joining Threads:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;void join()&lt;/code&gt; : The calling/current* thread will wait for &lt;b&gt;this&lt;/b&gt;
thread to die. &lt;b&gt;InterruptedException&lt;/b&gt; is thrown when any thread
interrupted the &lt;b&gt;current&lt;/b&gt; thread.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void join(long millis), void join(long millis, int nanos)&lt;/code&gt; :
passing &lt;code&gt;0&lt;/code&gt; to wait indefinitely.
&lt;/li&gt;
&lt;li&gt;This implementation uses a loop of &lt;code&gt;this.wait&lt;/code&gt; calls conditioned
on &lt;code&gt;this.isAlive&lt;/code&gt;. As a thread terminates the &lt;code&gt;this.notifyAll&lt;/code&gt;
method is invoked.
&lt;/li&gt;
&lt;li&gt;&lt;span class="underline"&gt;It is recommended that &lt;b&gt;applications&lt;/b&gt; not use &lt;code&gt;wait&lt;/code&gt;, &lt;code&gt;notify&lt;/code&gt;, or
&lt;code&gt;notifyAll&lt;/code&gt; on Thread instances&lt;/span&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Thread.UncaughtExceptionHandler&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;A Thread can set a handler when this thread abruptly terminates
due to an uncaught exception.
&lt;/li&gt;
&lt;li&gt;If the thread has not set a handler, its ThreadGroup (which
implements the Handler interface) acts as its handler.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;static void setDefaultUncaughtExceptionHandler()&lt;/b&gt; to set a global
default handler for all thread and will be called when the thread
has no handler set, and when its thread group (including parent
thread groups) does not specialize its &lt;code&gt;uncaughtException&lt;/code&gt; method.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ThreadGroup&lt;/b&gt; can forms a tree like structure.
&lt;/li&gt;
&lt;li&gt;Values stored in &lt;b&gt;thread-local&lt;/b&gt; variables are not related.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;InheritableThreadLocal&lt;/b&gt; : When a child thread is created, the child
receives &lt;b&gt;initial values&lt;/b&gt; for all &lt;b&gt;inheritable thread-local
variables&lt;/b&gt; for which the parent has values.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;protected T childValue(T parentValue)&lt;/code&gt;: method used to calculate the
child's initial value as a function of the parent's value at the
time the child thread is created. This is called from within the
parent thread before the child is started.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;java.util.Timer&lt;/b&gt; and &lt;b&gt;java.util.TimerTask&lt;/b&gt; for simple job scheduler
&lt;ul class="org-ul"&gt;
&lt;li&gt;Timer let you schedule TimerTask for future execution on a
background thread, which is known as the &lt;i&gt;task-execution thread&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;Timer tasks may be scheduled for one-shot execution, or for
repeated execution at regular intervals.
&lt;/li&gt;
&lt;li&gt;Timer scales to large numbers of concurrently scheduled timer
tasks. &lt;i&gt;Thousands of tasks should present no problem&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;Timer can be set as a daemon which will make the &lt;i&gt;task-execution
thread&lt;/i&gt; a daemon task.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-2" class="outline-3"&gt;
&lt;h3 id="sec-1-2"&gt;Synchronization&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;counter++&lt;/code&gt; : although a it might look like a single operation, it
is actually three separate operations: read, add 1 and write. It is
not thread safe.
&lt;/li&gt;
&lt;li&gt;The compiler, the Java virtual machine (JVM), and the operating
system can collaborate to cache a variable in a register or a
processor-local cacherather than rely on main memory.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;Each thread&lt;/b&gt; has its &lt;b&gt;own copy&lt;/b&gt; of the variable.
&lt;/li&gt;
&lt;li&gt;When one thread writes to this variable, itâs writing to its copy;
&lt;/li&gt;
&lt;li&gt;Other threads are unlikely to see the update in their copies.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Synchronization properties:
&lt;dl class="org-dl"&gt;
&lt;dt&gt; mutual exclusion &lt;/dt&gt;&lt;dd&gt;each thread is mutually excluded from
executing in critical section when another thread is inside the
critical section.
&lt;ul class="org-ul"&gt;
&lt;li&gt;the lock is often referred to as &lt;b&gt;mutex lock&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; property of visibility &lt;/dt&gt;&lt;dd&gt;ensures that a thread executing in a
critical section always sees the most recent changes to shared variables.
&lt;ul class="org-ul"&gt;
&lt;li&gt;It reads these variable from main memory on entry and writes
values to main memory on exit.
&lt;/li&gt;
&lt;li&gt;In practical terms, on current hardware, this typically causes
flushing of the CPU caches when a monitor is acquired and writes
to main memory when it is released, both of which are expensive.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/li&gt;
&lt;li&gt;Synchronisation is implemented using monitors. Each Java object is
associated with a monitor, which a thread can &lt;b&gt;lock&lt;/b&gt; or &lt;b&gt;unlock&lt;/b&gt;
by acquiring and releasing the monitor's lock (a token).
&lt;/li&gt;
&lt;li&gt;When a thread attempts to acquire a lock that it already holds, the
request succeeds.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;java.lang.Thread&lt;/code&gt; has a &lt;code&gt;static boolean holdsLock(Object o)&lt;/code&gt; method
that returns &lt;code&gt;true&lt;/code&gt; when the calling thread holds the lock on the
Object.
&lt;/li&gt;
&lt;li&gt;A thread that has acquired a lock &lt;b&gt;doesn't&lt;/b&gt; release this lock when
it calls one of the Thread's &lt;code&gt;sleep()&lt;/code&gt; methods.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;volatile&lt;/code&gt; exhibits the property of &lt;b&gt;visibility&lt;/b&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Using volatile, forces all accesses (read or write) to the
volatile variable to occur to main memory, effectively keeping the
volatile variable out of CPU caches.
&lt;/li&gt;
&lt;li&gt;Use &lt;code&gt;volatile&lt;/code&gt; only when visibility is an issue.
&lt;/li&gt;
&lt;li&gt;Only &lt;b&gt;field&lt;/b&gt; can be declared as volatile, not on local variable.
&lt;/li&gt;
&lt;li&gt;You can declare &lt;code&gt;double&lt;/code&gt; and &lt;code&gt;long&lt;/code&gt; fields to be &lt;code&gt;volatile&lt;/code&gt;, but
should avoid on &lt;b&gt;32-bit&lt;/b&gt; JVMs because it takes two operations to
access a &lt;code&gt;double&lt;/code&gt; or &lt;code&gt;long&lt;/code&gt; value.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;volatile&lt;/code&gt; field cannot also be declared &lt;code&gt;final&lt;/code&gt;. But this isn't a
problem because &lt;code&gt;final&lt;/code&gt; field can be safely accessed without
synchronization.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;volatile&lt;/code&gt; along can be thread unsafe if the operation involve the
volatile variable has multiple step. For example:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;check-then-act&lt;/b&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;read-modify-write&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/3519664/difference-between-volatile-and-synchronized-in-java"&gt;http://stackoverflow.com/questions/3519664/difference-between-volatile-and-synchronized-in-java&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-3" class="outline-3"&gt;
&lt;h3 id="sec-1-3"&gt;Waiting and Notification&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The &lt;code&gt;wait/notify&lt;/code&gt; enables one thread waits for a &lt;b&gt;condition&lt;/b&gt; to
exist. And another thread to create the condition and then notify
the waiting thread.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void wait()&lt;/code&gt;: cause the current thread to wait until another thread
invokes the &lt;code&gt;notify()&lt;/code&gt; or &lt;code&gt;notifyAll()&lt;/code&gt;, or for some other thread to
interrupt the current thread while waiting.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void notify()&lt;/code&gt;: Wake up a &lt;b&gt;single&lt;/b&gt; thread that's waiting on this
object's monitor.
&lt;ul class="org-ul"&gt;
&lt;li&gt;If more than one threads are waiting on this object,
one(arbitrary) of them is chosen.
&lt;/li&gt;
&lt;li&gt;The awakened thread will not be able to proceed until the current
thread relinquishes the lock on this object.
&lt;/li&gt;
&lt;li&gt;A thread releases ownership of the monitor associated with the
object whose &lt;code&gt;wait()&lt;/code&gt; method is called.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;This API leverages an object's &lt;b&gt;condition queue&lt;/b&gt;, which is a
data structure that stores threads waiting for a condition to exists.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The waiting threads are known as the &lt;b&gt;wait set&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Because the condition queue is tightly bound to an object's lock,
all methods in this API must be called from within a synchronized
context. The current thread must be the owner of the object's
monitor.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;synchronized&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;condition&lt;/span&gt; &lt;span class="n"&gt;does&lt;/span&gt; &lt;span class="n"&gt;not&lt;/span&gt; &lt;span class="n"&gt;hold&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
	&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;wait&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="c1"&gt;//perform an action that's appropriate to condition.&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Because of the possibility of &lt;b&gt;spurious wakeups&lt;/b&gt;, a thread might
wakes up without being notified, interrupted, or timingout),
&lt;code&gt;wait()&lt;/code&gt; is called from within the &lt;code&gt;while&lt;/code&gt; loop.
&lt;/li&gt;
&lt;li&gt;Never call a &lt;code&gt;wait()&lt;/code&gt; outside a loop.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Otherwise &lt;b&gt;java.lang.IllegalMonitorStateException&lt;/b&gt; is thrown.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;In &lt;b&gt;java.util.concurrent.locks.Condition&lt;/b&gt;, it factors out these
Object's monitor methods into distinct objects to give the effect of
having multiple &lt;b&gt;wait-sets&lt;/b&gt; per object, by combining them with the
use of arbitrary &lt;b&gt;Lock&lt;/b&gt; implementations.
&lt;/li&gt;
&lt;li&gt;Where a &lt;b&gt;Lock&lt;/b&gt; replaces the use of &lt;code&gt;synchronized&lt;/code&gt; methods and
statements, a &lt;b&gt;Condition&lt;/b&gt; replaces the use of the Object monitor
methods.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-4" class="outline-3"&gt;
&lt;h3 id="sec-1-4"&gt;Concurrency Utilities and Executors&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-4"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The &lt;b&gt;ExecutorService&lt;/b&gt; extends &lt;b&gt;Executor&lt;/b&gt;, is typically implemented
by a thread pool.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;invokeAll&lt;/code&gt;, &lt;code&gt;invokeAny&lt;/code&gt; perform the bulk execution, executing a
collection of tasks and then waiting for at least one, or all, to
complete.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;CompletionService&lt;/b&gt; interface and its implementation
&lt;b&gt;ExecutorCompletionService&lt;/b&gt;, arranges that submitted tasks are, upon
completion, placed on a queue accessible using
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;take()&lt;/code&gt;: which will block until a result is available.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;poll()&lt;/code&gt;: which will return &lt;code&gt;null&lt;/code&gt; if no result is available.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-5" class="outline-3"&gt;
&lt;h3 id="sec-1-5"&gt;Synchronizers&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-5"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Countdown Latches : causes one or more threads to wait at a &lt;i&gt;gate&lt;/i&gt;
until another thread open this gate, at which point these other
threads can continue.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;void await(), void await(long timeout, TimeUnit unit)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void countDown()&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Cyclic Barriers : lets a set of threads wait for each other to reach
a common barrier point.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Useful in &lt;b&gt;parallel decomposition&lt;/b&gt; scenarios, where a lengthy task
is divided into subtasks whose individual results are later merged
into the overall result of the task.
&lt;/li&gt;
&lt;li&gt;The barrier is &lt;i&gt;cyclic&lt;/i&gt; because it can be reused after the waiting
threads are released.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CyclicBarrier(int parties)&lt;/code&gt; : specific number of parties( threads
working toward a common goal)
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CyclicBarrier(int parties, Runnable barrierAction)&lt;/code&gt; : the
barrierAction is executed when the barrier is &lt;i&gt;tripped&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;int await(), int ~await(long timeout, TimeUnit unit)&lt;/code&gt; : force
the calling thread to wait until all parties have invoked
&lt;code&gt;await()&lt;/code&gt; on this cyclic barrier.
&lt;ul class="org-ul"&gt;
&lt;li&gt;the method return the arrival index of the calling thread, where
a index  &lt;code&gt;getParties() -1&lt;/code&gt; indicates the first thread to arrive,
and &lt;code&gt;zero&lt;/code&gt; indicates the last thread to arrive (countdown).
&lt;/li&gt;
&lt;li&gt;The calling thread will &lt;b&gt;also stop waiting&lt;/b&gt; when it, or &lt;b&gt;another
waiting thread&lt;/b&gt; is interrupted, timeout, or &lt;code&gt;reset()&lt;/code&gt; is called
on this cyclic barrier.
&lt;/li&gt;
&lt;li&gt;If the calling thread on wait is interrupted, this thread will
throw &lt;b&gt;InterruptedException&lt;/b&gt;, while other waiting thread will
throw &lt;b&gt;BrokenBarrierException&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;boolean isBroken()&lt;/code&gt; : return &lt;code&gt;true&lt;/code&gt; when one or more parties
broke out of this barrier because of interruption or timeout
since the cyclic barrier was constructed, or last reset.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void reset()&lt;/code&gt; : reset the barrier to its initial state. If any
parties are currently waiting at the barrier, they will return
with a &lt;b&gt;BrokenBarrierException&lt;/b&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Exchangers :provides a synchronization point where threads can swap
objects.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Each thread presents some boject on entry to the exchanger's
&lt;code&gt;exchange()&lt;/code&gt; method, matches with a partner thread, and receives
its partner's object on return.
&lt;/li&gt;
&lt;li&gt;Useful in applications such as genetic algorithms and pipeline
design.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;java.util.concurrent.Exchanger&amp;lt;V&amp;gt;&lt;/code&gt; has &lt;code&gt;V exchange(V x)&lt;/code&gt; method:
wait for another thread to arrive at this exchange point and then
transfer the given object to it, receiving the other thread's
object in return.
&lt;ul class="org-ul"&gt;
&lt;li&gt;If another thread is already waiting at the exchange point:
&lt;ul class="org-ul"&gt;
&lt;li&gt;It is resumed for thread-scheduling purposes and receives the
object passed in by the calling thread.
&lt;/li&gt;
&lt;li&gt;The current threads return immediately.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Semaphores : maintains a set of &lt;b&gt;permits&lt;/b&gt; for restricting the member
of threads that can access a limited resource.
&lt;ul class="org-ul"&gt;
&lt;li&gt;A thread attempting to acquire a permit when no permits are
available blocks until some other thread releases a permit.
&lt;/li&gt;
&lt;li&gt;Semaphores whose values can be more than 1 are known as &lt;b&gt;counting
semaphores&lt;/b&gt;
&lt;/li&gt;
&lt;li&gt;Semaphores whoese value can be only 0 or 1 are known as &lt;b&gt;binary
semaphores&lt;/b&gt;, or &lt;b&gt;mutexes&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Semaphore can set to be fair (fairness policy) :
&lt;ul class="org-ul"&gt;
&lt;li&gt;when &lt;code&gt;false&lt;/code&gt;, i.e., not fair, it makes no guarantees about the
order in which threads acquire permites.
&lt;/li&gt;
&lt;li&gt;when &lt;code&gt;true&lt;/code&gt;, it guarantees the order as in FIFO, i.e., the first
thread invoking &lt;code&gt;acquire()&lt;/code&gt; will get the permit first.
&lt;/li&gt;
&lt;li&gt;Generally, semaphores used to control resource access should be
initialized as fair (&lt;b&gt;by default, it is not&lt;/b&gt;) to ensure that no
therad is starved out from accessing a resource.
&lt;/li&gt;
&lt;li&gt;When using semaphores for other kinds of synchronization
control, the throughput advantages of unfair ordering often
outweight fairness considerations.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void acquire()&lt;/code&gt;, &lt;code&gt;void acquire(int permits)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;boolean tryAcquire()&lt;/code&gt;, &lt;code&gt;boolean tryAcquire(int permits)&lt;/code&gt;:
acquire permits only when they are available at the time of
invocation.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;boolean tryAcquire(long timeOut, TimeUnit unit)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void release()&lt;/code&gt;, &lt;code&gt;void release(int permits)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void acquireUninterruptibly()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;int drainPermits()&lt;/code&gt;: accquire and return a count of all permits
that are immediately available.
&lt;/li&gt;
&lt;li&gt;
&lt;/li&gt;&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Phasers : is a more flexible cyclic barrier.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Is sueful when we have some concurrent tasks divided in steps. And
this class enable us to synchronize the threads at the end of each
steps.
&lt;ul class="org-ul"&gt;
&lt;li&gt;so no thread starts its next step until all the threads
have finished the previous one.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Let a group of threads wait on a barrier; these threads continue
after the last thread arrives.
&lt;/li&gt;
&lt;li&gt;Cyclic barrier coordinates a &lt;b&gt;fixed&lt;/b&gt; number of threads, while a
phaser can coordiantes a &lt;b&gt;variable number&lt;/b&gt; of threads, which can
register at any time.
&lt;/li&gt;
&lt;li&gt;A &lt;b&gt;phase&lt;/b&gt; is the phaser's &lt;i&gt;current state&lt;/i&gt;, and this state is
identified by an integer-based &lt;b&gt;phase number&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Phaser(int nthreads)&lt;/code&gt; : constructor creates a phaser that
initially coordiates &lt;code&gt;nthreads&lt;/code&gt; threads, and whose &lt;i&gt;phase number&lt;/i&gt; is
initially set to &lt;code&gt;0&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;int register()&lt;/code&gt; : add a new unarrived thread to this phaser and
returns the phase number to classify the arrival.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;int arriveAndAwaitAdvance()&lt;/code&gt; : records arrival and &lt;b&gt;wait&lt;/b&gt; for the
phaser to advance. Return the phase number to which the arrival
applies.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;int arriveAndDeregister()&lt;/code&gt; : arrives at this phaser and
deregister from it without waiting for others to arrive, reducing
the number of threads required to avdance in future phases.
&lt;/li&gt;
&lt;li&gt;TODO. need to have better understanding.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-6" class="outline-3"&gt;
&lt;h3 id="sec-1-6"&gt;The Locking Framework&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-6"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;synchronized&lt;/code&gt; keyword is to wrap &lt;b&gt;critical sections&lt;/b&gt;. JVM supports
synchronization via monitors and the &lt;code&gt;monitorenter&lt;/code&gt; and
&lt;code&gt;monitorexit&lt;/code&gt; JVM instructions.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Every Java object is associated with a monitor, which is &lt;b&gt;a mutual
exclusion&lt;/b&gt; construct.
&lt;/li&gt;
&lt;li&gt;When a thread locks a monitor in multicore/multiprocessor
environment, the value of shared variables that are stored in main
memory are read into the &lt;b&gt;local memory&lt;/b&gt; or &lt;b&gt;cache memory&lt;/b&gt; of the
thread.
&lt;/li&gt;
&lt;li&gt;When a thread unlock the monitor while leaving the critical section,
the values in its copies are written back to main memory.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The more flexible &lt;b&gt;Lock&lt;/b&gt; interface:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;void lock()&lt;/code&gt; : doesn't allow for interruption.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void lockInterruptibly()&lt;/code&gt; : allow for interruption.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;boolean tryLock()&lt;/code&gt;, &lt;code&gt;boolean tryLock(long time, TimeUnit unit)&lt;/code&gt; :
timeout, or interrupted.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;void unlock()&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ReentrantLock&lt;/b&gt; class implements the &lt;b&gt;Lock&lt;/b&gt; interface.
&lt;ul class="org-ul"&gt;
&lt;li&gt;It is a reentrant mutual exclusion lock.
&lt;/li&gt;
&lt;li&gt;This lock is associated with a hold count.
&lt;ul class="org-ul"&gt;
&lt;li&gt;When a thread holds the lock and &lt;b&gt;reacquires&lt;/b&gt; the lock, the hold
count increase by 1.
&lt;/li&gt;
&lt;li&gt;When unlock from the thread, the hold count is decreased by 1.
&lt;/li&gt;
&lt;li&gt;The lock is released when the count reaches 0.
&lt;/li&gt;
&lt;li&gt;This is why it is called a &lt;b&gt;reentrant&lt;/b&gt; lock.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ReentrantLock also support a fair ordering policy, by default
false.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;boolean isHeldByCurrentThread()&lt;/code&gt; return true when the lock is
hold by the current thread.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Condition&lt;/b&gt; interface factors out Object's wait and notification
methods into distinct condition objects.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;await()&lt;/code&gt; : wait to be signalled by the same condition.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The lock associated with this Condition is automatically
released and the current thread become disabled for thread
scheduling purpose and lies dormant until one of the following
four things happens:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;signal()&lt;/code&gt; called and the current thead happens to be chose to
be awaken.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;signalAll()&lt;/code&gt; called.
&lt;/li&gt;
&lt;li&gt;Is interrupted.
&lt;/li&gt;
&lt;li&gt;A &lt;i&gt;spurious wakeup&lt;/i&gt; occurs: this is why the await normally
need to be wrapped in while loop.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;In all cases, before &lt;code&gt;await()&lt;/code&gt; can return, the current thread
must &lt;b&gt;re-acquire&lt;/b&gt; the lock associated with this condition. The
thread is guaranteed to hold this lock when the method return.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;signal()&lt;/code&gt;, &lt;code&gt;signalAll()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;The two methods are protected with the lock to ensure mutual
exclusion.
&lt;/li&gt;
&lt;li&gt;the &lt;code&gt;await()&lt;/code&gt; is normally wrapped in a while loop on the checked
condition.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The Lock replaces synchronized methods, Condition replaces Object's
wait/notification methods.
&lt;/li&gt;
&lt;li&gt;A Condition instance is intrinsically bound to a lock. To obtain a
Condition instance for a certain Lock instance, use the Lock's
&lt;code&gt;newCondition()&lt;/code&gt; method.
&lt;/li&gt;
&lt;li&gt;Multiple condition can be created from a Lock.
&lt;/li&gt;
&lt;li&gt;Example:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BoundedBuffer&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Lock&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ReentrantLock&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Condition&lt;/span&gt; &lt;span class="n"&gt;notFull&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newCondition&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Condition&lt;/span&gt; &lt;span class="n"&gt;notEmpty&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newCondition&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;items&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;putptr&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;takeptr&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;InterruptedException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	&lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
		&lt;span class="n"&gt;notFull&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;await&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	    &lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;putptr&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(++&lt;/span&gt;&lt;span class="n"&gt;putptr&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;putptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	    &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	    &lt;span class="n"&gt;notEmpty&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;finally&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;unlock&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="nf"&gt;take&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;InterruptedException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	&lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
		&lt;span class="n"&gt;notEmpty&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;await&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	    &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;takeptr&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
	    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(++&lt;/span&gt;&lt;span class="n"&gt;takeptr&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;takeptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	    &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	    &lt;span class="n"&gt;notFull&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;finally&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;unlock&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ReadWriteLock&lt;/b&gt; interface defines a pair of locks: one for read-only
operations and one for write operations.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The read lock may be held simultaneously by multiple reader
threads as long as there are no writes.
&lt;/li&gt;
&lt;li&gt;The write lock is exclusive: only a single thread can modify
shared data.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ReadWriteLock&lt;/b&gt; is implemented by the &lt;b&gt;ReentrantReadWriteLock&lt;/b&gt;
  class.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;StampedLock&lt;/b&gt; is another implementation of &lt;b&gt;ReadWriteLock&lt;/b&gt;. The main
differences are:
&lt;ul class="org-ul"&gt;
&lt;li&gt;StampedLock allow optimistic locking for read operations.
&lt;/li&gt;
&lt;li&gt;ReentrantReadWriteLock are reentrant while stampedlock are not.
&lt;/li&gt;
&lt;li&gt;When the readers are much more than writers, the StampedLock can
significantly improve performance.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-7" class="outline-3"&gt;
&lt;h3 id="sec-1-7"&gt;LockSupport&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-7"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;This class associates with each thread that uses it, &lt;b&gt;a permit&lt;/b&gt; (in
the sense of the Semaphore class).
&lt;ul class="org-ul"&gt;
&lt;li&gt;A call to &lt;code&gt;static void park()&lt;/code&gt; return immediately if the permit is available,
consuming it in the process; otherwise it &lt;b&gt;may&lt;/b&gt; block.
&lt;/li&gt;
&lt;li&gt;A call to &lt;code&gt;static void unpark(Thread thread)&lt;/code&gt;, if it was not
already available.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;park()&lt;/code&gt; will return if the caller's thread was interrupted, and
timeout versions are supported
&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;park()&lt;/code&gt; method may also return at any other time, for "&lt;b&gt;no
reason&lt;/b&gt;", so in general must be invoked within a loop that
rechecks condition upon return.
&lt;/li&gt;
&lt;li&gt;In this sense, &lt;code&gt;park&lt;/code&gt; serves as an optimization of a &lt;b&gt;busy wait&lt;/b&gt;
that doesn't waste as much time spining, but must be paired with
an &lt;code&gt;unpark&lt;/code&gt; to be effective.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Unlike Semaphore's permits, permits of LockSupport are associated
with threads (i.e. permit is given to a particular thread) and
doesn't accumulate, i.e. there can be only one permit per thread,
when thread consumes the permit, it disappears).
&lt;/li&gt;
&lt;li&gt;You can give permit to a thread by calling unpark(). When permit is
available, the parked thread consumes it and exits a park() method.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-8" class="outline-3"&gt;
&lt;h3 id="sec-1-8"&gt;Concurrent Collections&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-8"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The concurrent collections return &lt;b&gt;weakly-consistent iterators&lt;/b&gt;:
&lt;ul class="org-ul"&gt;
&lt;li&gt;An elements that is removed after iteration starts but hasn't yet
been returned via the iterator's &lt;code&gt;next()&lt;/code&gt; method &lt;b&gt;won't&lt;/b&gt; be
returned.
&lt;/li&gt;
&lt;li&gt;An element that's added after iteration starts &lt;b&gt;may or may not&lt;/b&gt; be
returned.
&lt;/li&gt;
&lt;li&gt;No element is returned more than once during the iteration of a
collection, regardless of changes made to the collection during
iteration.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;BlockingQueue&lt;/b&gt;'s implementation:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;ArrayBlockingQueue&lt;/b&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;LinkedBlockingQueue&lt;/b&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;PriorityBlockingQueue&lt;/b&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;SynchronousQueue&lt;/b&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;DelayQueue&lt;/b&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;LinkedTransferQueue&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ConcurrentMap&lt;/b&gt;'s additional methods:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;V putIfAbsent(K key, V value)&lt;/code&gt; : combines the &lt;code&gt;containsKey&lt;/code&gt; and
&lt;code&gt;put&lt;/code&gt; for a atomic operation.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;boolean remove(Object key, Object value)&lt;/code&gt; : remove the entry for
a key only if currently mapped to a given value.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;boolean replace(K key, V oldValue, V newValue)&lt;/code&gt;: replace the
entry for a key only if currently mapped to a given value.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-9" class="outline-3"&gt;
&lt;h3 id="sec-1-9"&gt;Atomic Variables&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-9"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The atomic classes extends the notion of &lt;code&gt;volatile&lt;/code&gt; values, fields,
and array elements to those that also provide an atomic conditional
update so that external synchronisation isn't required.
&lt;/li&gt;
&lt;li&gt;The atomic arrays: &lt;b&gt;AtomicIntegerArray&lt;/b&gt;, &lt;b&gt;AtomicLongArray&lt;/b&gt; and
&lt;b&gt;AtomicReferenceArray&lt;/b&gt;. Its elements may be updated atomically.
&lt;/li&gt;
&lt;li&gt;For scalability problem in the context of maintaining a single
&lt;b&gt;count&lt;/b&gt;, a &lt;b&gt;sum&lt;/b&gt; or some other value with the possibility of updates
from many threads:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Internally employ contention-reduction techniques that provide
huge throughput improvements compared to atomic variables.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;DoubleAccumulator&lt;/b&gt; and &lt;b&gt;LongAccumulator&lt;/b&gt;: Take a BinaryOperator
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;DoubleAdder&lt;/b&gt; and &lt;b&gt;LongAdder&lt;/b&gt;: provides analogy of the
functionality of the accumulators for the common special case of
maintaining counts and sums.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;new LongAdder()&lt;/code&gt; is equivalent to &lt;br&gt;
    &lt;code&gt;new LongAccumulator ((x+y)-&amp;gt;x+y), 0l)&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Java's low-level synchronisation mechanism impacts hardware
utilisation and scalability in the following ways:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;Contended synchronisation&lt;/b&gt; where multiple threads constantly
competing for a lock, is expensive and throughput suffers as a result.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The expense is caused mainly by the frequent &lt;b&gt;context switching&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Each &lt;b&gt;context switch&lt;/b&gt; operation can take many processor cycles to
complete.
&lt;/li&gt;
&lt;li&gt;Modern JVM make &lt;b&gt;uncontended synchronisation&lt;/b&gt; inexpensive.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;When a thread holding a lock is delayed (because of a scheduling
delay for example), no thread that requires that lock makes any progress.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;volatile&lt;/code&gt; cannot be used as a synchronization alternative.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;volatile&lt;/code&gt; variables only solve the visibility problem.
&lt;/li&gt;
&lt;li&gt;Cannot be used to safely implement the atomic &lt;b&gt;read-modify-write&lt;/b&gt;
    sequence.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Compare-and-Swap(CAS) is an &lt;b&gt;uninterruptible&lt;/b&gt; microprocessor specific
instruction that :
&lt;ol class="org-ol"&gt;
&lt;li&gt;Read value with an expected value,
&lt;/li&gt;
&lt;li&gt;Store a new value in the memory location if the read value matches
the expected value.
&lt;/li&gt;
&lt;li&gt;Otherwise, nothing is done.
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;CAS supports atomic &lt;b&gt;read-modify-write&lt;/b&gt; sequences:
&lt;ol class="org-ol"&gt;
&lt;li&gt;Read value &lt;code&gt;x&lt;/code&gt; from address &lt;code&gt;A&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;Perform a multistep computation on &lt;code&gt;x&lt;/code&gt; to drive a new value &lt;code&gt;y&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;Use CAS to change ghe value of &lt;code&gt;A&lt;/code&gt; from &lt;code&gt;x&lt;/code&gt; to &lt;code&gt;y&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;CAS succeeds when &lt;code&gt;A&lt;/code&gt;'s value hasn't changed while performing
these steps.
&lt;/li&gt;
&lt;li&gt;This is normally wrapped in a while loop to repeat until success.
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ReentrantLock&lt;/b&gt; offers better performance than &lt;code&gt;synchronized&lt;/code&gt; under
high thread contention.
&lt;ul class="org-ul"&gt;
&lt;li&gt;its synchronization is managed by a subclass of
&lt;code&gt;java.util.concurrent.locks.AbstractQueuedSynchronizer&lt;/code&gt;,
&lt;/li&gt;
&lt;li&gt;which in turn, leverages the &lt;code&gt;sun.mics.Unsafe&lt;/code&gt; class and its
&lt;code&gt;compareAndSwapInt()&lt;/code&gt; CAS method.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The atomic variable classes also leverage CAS with a method:
&lt;code&gt;boolean compareAndSet(expectedValue, updateValue)&lt;/code&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-10" class="outline-3"&gt;
&lt;h3 id="sec-1-10"&gt;Fork/Join&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-10"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Fork/Join consists of a special &lt;b&gt;executor service&lt;/b&gt; and &lt;b&gt;thread
pool&lt;/b&gt;:
&lt;ul class="org-ul"&gt;
&lt;li&gt;The executor service makes a task available to the framework,
&lt;/li&gt;
&lt;li&gt;And this task is broken into smaller tasks that are forked
(executed by different threads) from the pool.
&lt;/li&gt;
&lt;li&gt;A task waits until joined (its subtasks finish).
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;TODO
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-11" class="outline-3"&gt;
&lt;h3 id="sec-1-11"&gt;CompletionService&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-11"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;A service that decouples the production of new tasks from the
consumption of the tasks' results &lt;b&gt;in the order&lt;/b&gt; they complete.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Producer &lt;code&gt;submit&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;Consumer &lt;code&gt;poll&lt;/code&gt; or &lt;code&gt;take&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;poll()&lt;/code&gt; : Retrieves and removes the Future representing the next
completed task, or &lt;code&gt;null&lt;/code&gt; if none are present.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;poll(long timeout, TimeUnit unit)&lt;/code&gt;: waiting if necessary.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;take()&lt;/code&gt; : block if none are yet present.
&lt;/li&gt;
&lt;li&gt;Difference between executor service and completion service:
&lt;ul class="org-ul"&gt;
&lt;li&gt;ExecutorService provides an incoming queue for tasks and provides
workers threads.
&lt;/li&gt;
&lt;li&gt;CompletionService provides an incoming queue for tasks, worker
threads, &lt;b&gt;and&lt;/b&gt; an output queue for storing task results.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-12" class="outline-3"&gt;
&lt;h3 id="sec-1-12"&gt;Testing Concurrent Applications&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-12"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Monitoring &lt;b&gt;ReentrantLock&lt;/b&gt; with its methods:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;protected Thead getOwner()&lt;/code&gt; : return the Thread that currently
owns this lock, or null if not owned.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Noticed that this is a protected method, so to use it one will
need to extend.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;protected getQueuedThreads()&lt;/code&gt; : return the collection containing
the threads that may be waiting to acquire this lock.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;protected getWaitingThreads(Condition condition)&lt;/code&gt; : return the
collection containing the threads that may be waiting ont he given
condition associated with this lock.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isHeldbycurrentthread()&lt;/code&gt; queries if this lock is hold by the
current thread.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isLocked()&lt;/code&gt; : indicating if this lock is owned by a thread.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;MultithreadedTC&lt;/b&gt; is a library for testing concurrent application.
&lt;ul class="org-ul"&gt;
&lt;li&gt;It features a &lt;b&gt;metronome/clock&lt;/b&gt; that is used to provide &lt;b&gt;fine control&lt;/b&gt;
    over &lt;b&gt;the sequence of activities&lt;/b&gt; in multiple threads.
&lt;/li&gt;
&lt;li&gt;It supports test cases that execise a &lt;b&gt;specific&lt;/b&gt; interleaving of
the threads.
&lt;/li&gt;
&lt;li&gt;It is motivited by the &lt;b&gt;principle&lt;/b&gt; that &lt;i&gt;cuncurrent application
shoul be built using &lt;b&gt;small concurrent abstractions&lt;/b&gt;&lt;/i&gt; such as
&lt;i&gt;bounded buffers&lt;/i&gt;, &lt;i&gt;semaphores&lt;/i&gt; and &lt;i&gt;latches&lt;/i&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Separating the concurrency logic from the rest of the application
logic in this way makes it easier to understand and test
concurrent applications.
&lt;/li&gt;
&lt;li&gt;Since these abstractions are small, it should be possible to
&lt;b&gt;deterministically&lt;/b&gt; test every &lt;b&gt;significant&lt;/b&gt; interleaving in
separate tests.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;It uses an internal clock:
&lt;ul class="org-ul"&gt;
&lt;li&gt;the clock only advances to the next tick when all threads are
blocked.
&lt;/li&gt;
&lt;li&gt;waitForTick(1) : makes thread block until the clock reaches tick
1 before assuming. The interger received in this method is used
to control the order of execution.
&lt;/li&gt;
&lt;li&gt;assertTick(1) : assert that the clock is in tick 1.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>concurrency</category><category>java</category><guid>https://wudong.graceliu.uk/posts/notes/java-concurrency/</guid><pubDate>Thu, 13 Jul 2017 23:00:00 GMT</pubDate></item><item><title>Java HotSpot VM GC Tunning Guide</title><link>https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/</link><dc:creator>Warren Liu</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-1"&gt;How GC Works&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-2"&gt;GC in Young Generation&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-2-1"&gt;Minor GC&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-3"&gt;GC in old generation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-4"&gt;Behaviour Goals&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-5"&gt;Tunning Strategy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-6"&gt;Arrangement of Generation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-7"&gt;Measurement&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-8"&gt;Sizing the Generations&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-9"&gt;GC Algorithms&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-9-1"&gt;Marking reachable objects&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-9-2"&gt;Removing unused objects&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-10"&gt;Available Collectors&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-10-1"&gt;Selecting a Collector:&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-11"&gt;Concurrent GC&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-11-1"&gt;CMS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/#sec-11-2"&gt;G1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;
References
&lt;i&gt;- https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/toc.html&lt;/i&gt;
&lt;/p&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;a href="https://plumbr.eu/handbook/garbage-collection-in-java"&gt;https://plumbr.eu/handbook/garbage-collection-in-java&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;
A garbage collector (GC) is a memory management tool. It achieves
automatic memory management through the following operations:
&lt;/p&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Allocating objects to a &lt;b&gt;young generation&lt;/b&gt; and promoting aged objects
into an &lt;b&gt;old generation&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Finding live objects in the old generation through a concurrent
(parallel) &lt;b&gt;marking&lt;/b&gt; phase. The Java HotSpot VM triggers the marking
phase when the total Java heap occupancy exceeds the default
threshold.
&lt;/li&gt;
&lt;li&gt;Recovering free memory by compacting live objects through parallel
copying.
&lt;/li&gt;
&lt;/ul&gt;

&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;How GC Works&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;In most configurations the operating system allocates the heap in
advance to be managed by the JVM while the program is running. This
has a couple of important ramifications
&lt;ul class="org-ul"&gt;
&lt;li&gt;Object creation is faster because global synchronization with the
OS is not needed for every single object.
&lt;/li&gt;
&lt;li&gt;When an object is no longer used, the GC reclaims the underlying
memory and reuses it for future object allocation. This means
there is no explicit deletion and no memory is given back to OS.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;GC Roots: The source of all object trees
&lt;ul class="org-ul"&gt;
&lt;li&gt;Special objects called GC roots are always reachable and so is any
object that has a GC root as its own root.
&lt;/li&gt;
&lt;li&gt;There are four kinds of GC root in JAVA:
-Local variables in the stack of a thread.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Active Java threads and its thread local variable.
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
-Static variables referenced by their classes. Classes themselves
can be GCed, which would remove all referenced static variables.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;JNI References, which are java objects that native code has
created as part of a JNI call. Object thus created is theated
specially because the JVM doesn't know if it is being referenced
by the native code.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Marking and Sweeping away garbage.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The algorithm traverses all object references, starting with the
GC roots, and marks every object found as alive.
&lt;/li&gt;
&lt;li&gt;All that is not marked alive is reclaimed.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-2" class="outline-2"&gt;
&lt;h2 id="sec-2"&gt;GC in Young Generation&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Young generation is divided into 3 spaces:
&lt;ul class="org-ul"&gt;
&lt;li&gt;One Eden space
&lt;/li&gt;
&lt;li&gt;Two survivor spaces.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Allocating new objects using &lt;code&gt;new&lt;/code&gt; operator (almost) always happens
in Eden space. Eden space is behave like a &lt;b&gt;Stack&lt;/b&gt; when allocating
memory.
&lt;/li&gt;
&lt;li&gt;Eden space full will trigger minor GC:
&lt;ol class="org-ol"&gt;
&lt;li&gt;Traverse graph of objects starting from GC roots
&lt;/li&gt;
&lt;li&gt;Copy all objects reachable from GC roots to one of &lt;b&gt;survivor&lt;/b&gt;
     spaces.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Wipe&lt;/b&gt; out Eden space (basically just moving this stack pointer back to 0)
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Subsequent minor collections there are additional steps:
&lt;ul class="org-ul"&gt;
&lt;li&gt;One of survivor spaces is examined as well.
&lt;/li&gt;
&lt;li&gt;Live objects from both Eden and one of Survivor spaces are copied
to Second survivor space (which is empty). This means there is
always exactly one free survivor space.
&lt;/li&gt;
&lt;li&gt;Clean both Eden and the Survivor space.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Objects are copied between survivor spaces and Once given object
jumps back and forth too many times (configurable, 8 by default), it
is promoted to tenured space.
&lt;/li&gt;
&lt;li&gt;Major GC runs when tenured space is full.
&lt;/li&gt;
&lt;li&gt;Two techniques are used for faster memory allocations in HotSpot VM:
&lt;dl class="org-dl"&gt;
&lt;dt&gt; Bump-the-pointer &lt;/dt&gt;&lt;dd&gt;tracks the last object allocated to the Eden
space. That object will be located on &lt;b&gt;top&lt;/b&gt; of the Eden
space. If there is an object crated afterwords, the new object
will be created on top of the last tracked object.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Lock is needed in multithread environment to track the last
object location.
&lt;/li&gt;
&lt;li&gt;Performance drops due to lock contention.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Thread-Local Allocation Buffers &lt;/dt&gt;&lt;dd&gt;is a region of Eden, allows
each thread to have a small portion of the Eden space. Each
thread can only access their own TLAB.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The normal way objects are allocated in HotSpot is within a
TLAB. TLAB allocation can be done without synchronization with other
threads. Synchronization is only needed when a new TLAB is fetched.
&lt;/li&gt;
&lt;li&gt;The TLABs are dynamically resized during the execution for each
thread individually.
&lt;/li&gt;
&lt;li&gt;So if a thread allocates very much, the new TLABs that it gets
from the heap will increase in size.
&lt;/li&gt;
&lt;li&gt;When allocation inside a TLAB is not possible (typically because
there is not enough room there)
&lt;ul class="org-ul"&gt;
&lt;li&gt;The allocation moves on to a shared Eden space.
&lt;/li&gt;
&lt;li&gt;If no enough space in there either, a GC in Young generation
is triggered.
&lt;/li&gt;
&lt;li&gt;If the GC doesn't result in sufficient free memory inside
Eden, the object is allocated in the Old Generation.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Card-marking&lt;/b&gt; to handle &lt;b&gt;cross-generational&lt;/b&gt; reference
&lt;ul class="org-ul"&gt;
&lt;li&gt;When Eden space is being collected, the JVM use card-marking to
marks the rough location of objects in Eden that may have links to
them from the Old Generation.
&lt;/li&gt;
&lt;li&gt;They will essentially be root objects for the collection.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Promotion
&lt;ul class="org-ul"&gt;
&lt;li&gt;Objects that survivors the tenuring threshold are promoted to Old
generation.
&lt;/li&gt;
&lt;li&gt;The threshold is dynamically adjusted but can set a upper limit,
which is &lt;code&gt;15&lt;/code&gt; by default on HotSopt, can be set by
&lt;code&gt;XX:+MaxTenuringThreshold&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;Promotion may also happen &lt;b&gt;prematurely&lt;/b&gt; if the size of the
Survivor space is not enough to hold all of the live objects in
the Young generation.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-2-1" class="outline-3"&gt;
&lt;h3 id="sec-2-1"&gt;Minor GC&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-2-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Collecting garbage from the Young space is called Minor GC.
&lt;/li&gt;
&lt;li&gt;Minor GC is always triggered when the JVM is unable to allocate
space for a new object.
&lt;/li&gt;
&lt;li&gt;So the higher the allocation rate, the more frequently Minor GC
occurs.
&lt;/li&gt;
&lt;li&gt;During Minor GC, Tenured Generation is effectively ignored.
&lt;ul class="org-ul"&gt;
&lt;li&gt;References from Tenured generation is considered to be GC roots.
&lt;/li&gt;
&lt;li&gt;References from Young generation to Tenured generation is ignored.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Minor GC does trigger &lt;b&gt;stop-the-world&lt;/b&gt; pause.
&lt;/li&gt;
&lt;li&gt;However, for most applications, the length of the pause is
&lt;b&gt;negligible&lt;/b&gt; latency-wise if most of the objects in the Eden can be
considered garbage and are never copied to Survivor/Old space.
&lt;/li&gt;
&lt;li&gt;If the opposite is true, Minor GC pauses will take considerably more
time.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-3" class="outline-2"&gt;
&lt;h2 id="sec-3"&gt;GC in old generation&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Since most objects are expected to be alive in the Old Generation,
there is no &lt;b&gt;Mark and Copy&lt;/b&gt; happening.
&lt;/li&gt;
&lt;li&gt;Objects are moved around to minimize fragmentation.
&lt;/li&gt;
&lt;li&gt;In principle the steps are:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Mark reachable objects by setting the marked bit next to all
objects accessible through GC roots.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Delete&lt;/b&gt; all unreachable objects.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Compact&lt;/b&gt; the content of the old space by &lt;b&gt;copying&lt;/b&gt; the live
objects &lt;b&gt;contiguously&lt;/b&gt; to the beginning of the old space.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;



&lt;div id="outline-container-sec-4" class="outline-2"&gt;
&lt;h2 id="sec-4"&gt;Behaviour Goals&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-4"&gt;
&lt;p&gt;
There two primary measures of garbage collection performance:
&lt;b&gt;Throughput&lt;/b&gt; and &lt;b&gt;Pause&lt;/b&gt;
&lt;/p&gt;

&lt;p&gt;
For parallel collector, Java SE provides two garbage collection
tunning parameters to achieve specific behavior gaols:
&lt;/p&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;Maximum Pause Time&lt;/b&gt;: &lt;br&gt;
  To limit the longest of the GC pause. This is
specified by command-line option &lt;code&gt;-XX:MaxGCPauseMillis=&amp;lt;nnn&amp;gt;&lt;/code&gt;, which
is interpreted as a hint to the garbage collector that the pause
time of &lt;code&gt;&amp;lt;nnn&amp;gt;&lt;/code&gt; or less is desired. &lt;b&gt;By default&lt;/b&gt;, there is no
maximum pause time goal, and these adjustments may cause garbage
collector to occur &lt;i&gt;more frequently&lt;/i&gt;, reducing the overall
&lt;b&gt;throughput&lt;/b&gt; of the application.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Throughout&lt;/b&gt;: &lt;br&gt;
  The throughput goal is measured in terms of time in GC and in
application respectively. With command-line option
&lt;code&gt;-XX:GCTimeRatio=&amp;lt;n&amp;gt;&lt;/code&gt;, the ratio of gc time to application time is
set to \(1/(1+n)\). If the goal cannot be met, the size of the
generations are increased in an effort to increase the application
time in between collections.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Footprint&lt;/b&gt;: &lt;br&gt;
  If the two of the above goals are met, the GC reduces the size of
the heap until one of the goals (invariably the throughput goal)
cannot be met.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-5" class="outline-2"&gt;
&lt;h2 id="sec-5"&gt;Tunning Strategy&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-5"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Do not choose a maximum value for the heap unless you know you need
a heap greater than the default maximum heap size. Choose a
throughput goal that is sufficent for your application.
&lt;/li&gt;
&lt;li&gt;If the application starts allocating at a higher rate, the heap will
grow to maintain the same throughput.
&lt;/li&gt;
&lt;li&gt;If the heap grows to its maximum size and the throughput goal is not
being met, the maximum heap size is too small for the throughput
goal. Set the maximum heap size to a value that is close to the
total physical memory on the platform but which does not cause
swapping of the application. If the throughput goal is still not
met, then the goal for the application time is too high for the
available memory on the platform.
&lt;/li&gt;
&lt;li&gt;If the throughput goal can be met, but there are pauses that are too
long, then select a maximum pause time goal. Choosing a maximum
pause time goal may mean that your throughput goal will not be met,
so choose values that are an acceptable compromise for the
application.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-6" class="outline-2"&gt;
&lt;h2 id="sec-6"&gt;Arrangement of Generation&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-6"&gt;
&lt;p&gt;
The default arrangement of generations, exception for parallel
collector and G1 looks like following:
&lt;/p&gt;


&lt;div class="figure"&gt;
&lt;p&gt;&lt;img src="https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/img/jsgct_dt_001_armgnt_gn.png" alt="jsgct_dt_001_armgnt_gn.png"&gt;
&lt;/p&gt;
&lt;/div&gt;

&lt;ul class="org-ul"&gt;
&lt;li&gt;At initialization, a maximum address space is virtually reserved but
&lt;b&gt;not allocated to physical memory&lt;/b&gt; unless it is needed. The complete
address space reserved for object memory can be divided into the
young and tenured generations.
&lt;/li&gt;
&lt;li&gt;The young generation consists of &lt;b&gt;eden&lt;/b&gt; and &lt;b&gt;two survivor spaces&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Most objects are initially allocated in &lt;b&gt;eden&lt;/b&gt;. One survivor space is
&lt;i&gt;empty at any time&lt;/i&gt;, and serves as the destination of any live objects
in eden; the other survivor space is the destination during the next
&lt;b&gt;copying collection&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Objects are copied between survivor spaces in this way until they
are old enough to be tenured, and copied to the &lt;b&gt;tenured generation&lt;/b&gt;.
&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;
In general, choosing the size for a particular generation is a
trade-off between these &lt;i&gt;considerations of throughput, or puase time,
footprint, or promptness&lt;/i&gt;:
&lt;/p&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;A very large young generation may maximize throughput, but does so
at the expense of footprint, promptness, and pause times.
&lt;/li&gt;
&lt;li&gt;Young generation pauses can be minimized by using a small young
generation at the expense of throughput.
&lt;/li&gt;
&lt;li&gt;The sizing of one generation does not affect the collection
frequency and pause times for another generation.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-7" class="outline-2"&gt;
&lt;h2 id="sec-7"&gt;Measurement&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-7"&gt;
&lt;p&gt;
The command-line option &lt;code&gt;-verbose:gc&lt;/code&gt; causes information about the heap
and garbage collection to be printed at each collection. For example:
&lt;/p&gt;
&lt;p class="verse"&gt;
[GC 325407K-&amp;gt;83000K(776768K), 0.2300771 secs]&lt;br&gt;
[GC 325816K-&amp;gt;83372K(776768K), 0.2454258 secs]&lt;br&gt;
[Full GC 267628K-&amp;gt;83769K(776768K), 1.8479984 secs]&lt;br&gt;
&lt;/p&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The numbers before and after the arrow (for example, 325407K-&amp;gt;83000K
from the first line) indicate the combined size of live objects
before and after garbage collection, respectively.
&lt;/li&gt;
&lt;li&gt;The next number in parentheses (for example, (776768K) again from
the first line) is the &lt;b&gt;committed size of the heap&lt;/b&gt;: the amount of
space usable for Java objects &lt;b&gt;without&lt;/b&gt; requesting more memory from
the operating system.
&lt;/li&gt;
&lt;li&gt;Note that this number only includes one of the survivor
spaces. Except during a garbage collection, only one survivor space
will be used at any given time to store objects.
&lt;/li&gt;
&lt;li&gt;The last item on the line (for example, 0.2300771 secs) indicates
the time taken to perform the collection.
&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;
The command-line option &lt;code&gt;-XX:+PrintGCDetails&lt;/code&gt; causes additional
information about the collections to be printed:
&lt;/p&gt;
&lt;p class="verse"&gt;
[GC [DefNew: 64575K-&amp;gt;959K(64576K), 0.0457646 secs] 196016K-&amp;gt;133633K(261184K), 0.0459067 secs]&lt;br&gt;
&lt;/p&gt;
&lt;p&gt;
This indicates that the minor collection recovered about 98% of the
young generation, DefNew: 64575K-&amp;gt;959K(64576K) and took 0.0457646 secs
(about 45 milliseconds).
&lt;/p&gt;

&lt;p&gt;
The option &lt;code&gt;-XX:+PrintGCTimeStamps&lt;/code&gt; adds a time stamp at the start of
each collection. This is useful to see &lt;i&gt;how frequently&lt;/i&gt; garbage
collections occur.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-8" class="outline-2"&gt;
&lt;h2 id="sec-8"&gt;Sizing the Generations&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-8"&gt;
&lt;p&gt;
The different size parameters as illustrated in the following picture:&lt;br&gt;
&lt;img src="https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/img/jsgct_dt_006_prm_gn_sz.png" alt="jsgct_dt_006_prm_gn_sz.png"&gt;
&lt;/p&gt;

&lt;ul class="org-ul"&gt;
&lt;li&gt;At initialisation of vm, the &lt;b&gt;entire space&lt;/b&gt; for the heap is
&lt;b&gt;reserved&lt;/b&gt;. The size of the space reserved can be specified with &lt;code&gt;-Xmx&lt;/code&gt;
option.
&lt;/li&gt;
&lt;li&gt;If the value of &lt;code&gt;-Xms&lt;/code&gt; is smaller than the value of &lt;code&gt;-Xmx&lt;/code&gt;, not all
the space that is reserved is immediately committed to the virtual
machine. The uncommitted space is labelled as &lt;b&gt;virtual&lt;/b&gt; space.
&lt;/li&gt;
&lt;li&gt;Maximum heap size should always be smaller than the amount of memory
installed on the machine to avoid excessive page faults and
thrashing.
&lt;/li&gt;
&lt;li&gt;The different parts of the heap (tenured generation and young
generation) can grow to the limit of the virtual space as needed.
&lt;/li&gt;
&lt;li&gt;It can be seen from the picture that the &lt;b&gt;committed space&lt;/b&gt; is the memory
already acquired by Java, for the different generation.
&lt;/li&gt;
&lt;li&gt;After total available memory, the proportion of &lt;b&gt;young generation&lt;/b&gt;
is the second most influential factor of GC. &lt;i&gt;The bigger the young
generation, the less often minor collections occur&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;However, for a bounded heap size, a &lt;i&gt;larger young generation implies
a &lt;b&gt;smaller&lt;/b&gt; tenured generation&lt;/i&gt;, which will &lt;b&gt;increase&lt;/b&gt; the frequency
of major collections.
&lt;/li&gt;
&lt;li&gt;Parameter &lt;code&gt;NewRatio&lt;/code&gt; controls the young generation size. &lt;code&gt;-XX:NewRatio=3&lt;/code&gt;
means the ratio between the young and the tenured generation is
1:3. In other words, the combined size of the eden and the survivor
space will be one-forth of the total heap size.
&lt;/li&gt;
&lt;li&gt;Parameter &lt;code&gt;NewSize&lt;/code&gt; and &lt;code&gt;MaxNewSize&lt;/code&gt; bound the young generation.
&lt;/li&gt;
&lt;li&gt;Parameter &lt;code&gt;SurvivorRatio&lt;/code&gt; controls the survivor spaces, but it is
often not important for performance.
&lt;/li&gt;
&lt;li&gt;Increase the young generation size as you increase the number of
&lt;b&gt;processors&lt;/b&gt;, because allocation can be paralleled.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-9" class="outline-2"&gt;
&lt;h2 id="sec-9"&gt;GC Algorithms&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-9"&gt;
&lt;/div&gt;&lt;div id="outline-container-sec-9-1" class="outline-3"&gt;
&lt;h3 id="sec-9-1"&gt;Marking reachable objects&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-9-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;First, GC defines some specific objects as GC Roots.
&lt;/li&gt;
&lt;li&gt;Next, GC traverses the whole object graph in your memory, starting
from GC Roots and following references from the roots to other
objects.
&lt;/li&gt;
&lt;li&gt;The application threads need to be stopped for the marking to happen
as you cannot really traverse the graph if it keeps changing.
&lt;/li&gt;
&lt;li&gt;Such a situation when the application threads are temporarily
stopped so that JVM can indulge in housekeeping activities is called
a &lt;b&gt;safe point&lt;/b&gt; resulting in a &lt;b&gt;stop-the-world&lt;/b&gt; pause.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Safe points can be triggered for different reasons but GC is by
far the most common reason.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The duration of this pause depends either on total number of objects
in heap, nor on the size of the heap.
&lt;ul class="org-ul"&gt;
&lt;li&gt;But on &lt;b&gt;the number of alive objects&lt;/b&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-9-2" class="outline-3"&gt;
&lt;h3 id="sec-9-2"&gt;Removing unused objects&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-9-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Mark and &lt;b&gt;Sweep&lt;/b&gt;
  &lt;img src="https://plumbr.eu/wp-content/uploads/2015/06/GC-sweep.png" alt="GC-sweep.png"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;After marking phase, all space occupied by unvisited objects
is considered free and thus be reused.
&lt;/li&gt;
&lt;li&gt;Requires using the so called &lt;b&gt;free-list&lt;/b&gt; recording of every free
region and its size.
&lt;/li&gt;
&lt;li&gt;Increase memory fragmentation.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Mark-Sweep-Compact
&lt;img src="https://plumbr.eu/wp-content/uploads/2015/06/GC-mark-sweep-compact.png" alt="GC-mark-sweep-compact.png"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Solve the shortcomings of Mark and Sweep by moving all marked, and
thus alive, objects to the beginning of the memory region.
&lt;/li&gt;
&lt;li&gt;Increase pause time, but no fragmentation issues.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Mark and Copy
&lt;img src="https://plumbr.eu/wp-content/uploads/2015/06/GC-mark-and-copy-in-Java.png" alt="GC-mark-and-copy-in-Java.png"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Same as Mark and compact as it also relocate live objects.
&lt;/li&gt;
&lt;li&gt;The important difference is that the target of relocation.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-10" class="outline-2"&gt;
&lt;h2 id="sec-10"&gt;Available Collectors&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-10"&gt;
&lt;dl class="org-dl"&gt;
&lt;dt&gt; Serial Collector (&lt;code&gt;-XX:+UseSerialGC&lt;/code&gt;) &lt;/dt&gt;&lt;dd&gt;&lt;i&gt;no communication overhead
between threads&lt;/i&gt;, can be useful on multiprocessors for
applications with small data sets up to 100MB.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Using an algorithm called &lt;b&gt;mark-sweep-compact&lt;/b&gt;:
&lt;dl class="org-dl"&gt;
&lt;dt&gt; Mark &lt;/dt&gt;&lt;dd&gt;Marking the surviving objects
&lt;/dd&gt;
&lt;dt&gt; Sweep &lt;/dt&gt;&lt;dd&gt;Check the heap from the front and leaves only the
surviving ones.
&lt;/dd&gt;
&lt;dt&gt; Compact &lt;/dt&gt;&lt;dd&gt;Fills up the heap from the front with the objects so
that the objects are piled up consecutively, and
divides the heap into two parts: one with objects and
one without object.
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Parallel Collector (&lt;code&gt;-XX:+UseParallelGC&lt;/code&gt;) &lt;/dt&gt;&lt;dd&gt;also known as
&lt;i&gt;throughput collector&lt;/i&gt;. It performs &lt;b&gt;minor collections&lt;/b&gt; in
parallel, can significantly reduce the garbage collection
overhead.
&lt;ul class="org-ul"&gt;
&lt;li&gt;While serial GC uses only one thread to process a GC, Parallel GC
uses several threads to process a GC.
&lt;/li&gt;
&lt;li&gt;Its biggest advantage is that is uses multiple threads to scan
through and compact the heap.
&lt;/li&gt;
&lt;li&gt;The downside to the parallel collector is that it will stop
application threads when performing &lt;b&gt;either a minor or full&lt;/b&gt; GC
collection.
&lt;/li&gt;
&lt;li&gt;Intended for &lt;b&gt;medium-sized&lt;/b&gt; to &lt;b&gt;large-sized&lt;/b&gt; data sets that are
run on multiprocessor or multithreaded hardware.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Parallel compaction&lt;/b&gt; is a feature that enables parallel collector
to perform &lt;b&gt;major collections&lt;/b&gt; in parallel. Without it major
collections are performed using a &lt;i&gt;single thread&lt;/i&gt;. It is enabled by
default but can be turn off with &lt;code&gt;-XX:UseParallelOldGC&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;See the difference between serial and parallel collector:
&lt;img src="http://www.cubrid.org/files/attach/images/220547/284/313/difference-between-the-serial-gc-and-parallel-gc.png" alt="difference-between-the-serial-gc-and-parallel-gc.png"&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; &lt;b&gt;Concurrent Collector&lt;/b&gt; &lt;/dt&gt;&lt;dd&gt;performs most of its work concurrently,
while application is still running to keep GC pause short.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Designed for application with media to large sized data set in
which response time is more important than overall throughput.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;CMS Collector&lt;/b&gt; (-XX:+UseConcMarkSweepGC)
&lt;ul class="org-ul"&gt;
&lt;li&gt;See the difference between Serial Mark-Sweep-Compact and
Concurrent Mark-Sweep
&lt;/li&gt;
&lt;/ul&gt;

&lt;div class="figure"&gt;
&lt;p&gt;&lt;img src="http://www.cubrid.org/files/attach/images/220547/284/313/serial-gc-and-cms-gc.png" alt="serial-gc-and-cms-gc.png"&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;G1 Collector&lt;/b&gt; (-XX:+UseG1GC)
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-10-1" class="outline-3"&gt;
&lt;h3 id="sec-10-1"&gt;Selecting a Collector:&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-10-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Unless your application has strict pause time requirement, you
can always allow the VM to select a collector, and adjust heap
size to improve performance if necessary. Otherwise:
&lt;/li&gt;
&lt;li&gt;Use Serial Collector
&lt;ul class="org-ul"&gt;
&lt;li&gt;if the application has a small data set;
&lt;/li&gt;
&lt;li&gt;or if the application will be run on a single processor and no
pause time requirement;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Use Parallel Collector if:
&lt;ul class="org-ul"&gt;
&lt;li&gt;a peak application performance is the first priority
&lt;/li&gt;
&lt;li&gt;no pause time requirement
&lt;/li&gt;
&lt;li&gt;or pause of 1 second or longer are acceptable.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Use Concurrent GC if:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Response time is more important than overall throughput
&lt;/li&gt;
&lt;li&gt;and GC pause must be ketp shorter than 1 second
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-11" class="outline-2"&gt;
&lt;h2 id="sec-11"&gt;Concurrent GC&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-11"&gt;
&lt;/div&gt;&lt;div id="outline-container-sec-11-1" class="outline-3"&gt;
&lt;h3 id="sec-11-1"&gt;CMS&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-11-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Assuming that your heap is less than 4Gb in size.
&lt;/li&gt;
&lt;li&gt;CMS is only used in the Old generation, Yong generation still uses
Parallel GC.
&lt;/li&gt;
&lt;li&gt;The collector is designed to avoid long pauses while collecting in
the Old Generation. This is achieved by:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Does not compact the old generation but use &lt;b&gt;free-lists&lt;/b&gt; to manage
reclaimed space.
&lt;/li&gt;
&lt;li&gt;Does most of the job in the mark-and-sweep concurrently with the
application.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;This algorithm uses multiple threads (âconcurrentâ) to scan through
the heap (âmarkâ) for unused objects that can be recycled
(âsweepâ).
&lt;/li&gt;
&lt;li&gt;This algorithm will enter âstop the worldâ (STW) mode in two
cases. The steps are:
&lt;ol class="org-ol"&gt;
&lt;li&gt;Phase 1: Initial Mark(STW) :: when initialising the initial
marking of roots (objects in the old generation that are
reachable from thread entry points or static variables)
&lt;ul class="org-ul"&gt;
&lt;li&gt;References from GC roots.
&lt;/li&gt;
&lt;li&gt;References from Young generation.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Phase 2: Concurrent Mark :: traverses the Old Generation and
marks all live objects, starting from the roots found in the
previous phase of "Initial Mark".
&lt;ul class="org-ul"&gt;
&lt;li&gt;Concurrently running with the application threads.
&lt;/li&gt;
&lt;li&gt;Not all live objects &lt;b&gt;may&lt;/b&gt; be marked, since the application is
mutating reference during the marking.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Phase 3: Concurrent Preclean
&lt;ul class="org-ul"&gt;
&lt;li&gt;While the previous phase was running, some references can be
changed. Whenever that happens, the JVM marks the area of the
heap (called &lt;b&gt;Card&lt;/b&gt;) that contains the mutated objects as
"&lt;i&gt;dirty&lt;/i&gt;" (this is known as &lt;b&gt;Card Marking&lt;/b&gt;)
&lt;/li&gt;
&lt;li&gt;In the preclean phase, these dirty objects are accounted for,
and the objects reachable from them are also marked.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Phase 4: Concurrent Abortable Preclean :: attempts to takes as
much work off the stop-the-world Final Remark as possible.
&lt;/li&gt;
&lt;li&gt;Phase 5: Final Remark(STW) :: finalise the marking of objects in
the Old generation, since the previous steps are all running
concurrently, this is required to make the marking final.
&lt;/li&gt;
&lt;li&gt;Phase 6: Concurrent Sweep :: remove unused the objects and
reclaim the space occupied by them.
&lt;/li&gt;
&lt;li&gt;Phase 7: Concurrent Reset :: resetting inner data structure of
the CMS, and preparing them for the next cycle.
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Major drawbacks
&lt;ul class="org-ul"&gt;
&lt;li&gt;Old generation fragmentation
&lt;/li&gt;
&lt;li&gt;Lack of predictability in pause duration, especially on large
heaps.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-11-2" class="outline-3"&gt;
&lt;h3 id="sec-11-2"&gt;G1&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-11-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Was designed to better support heaps &lt;b&gt;larger than 4GB&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;A &lt;i&gt;soft real-time&lt;/i&gt; garbage collector, meaning that you can set
specific performance goals to it.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Request the stop-the-world pause to be no longer than &lt;code&gt;x&lt;/code&gt;
    milliseconds within any given &lt;code&gt;y&lt;/code&gt;-millisecond long time range.
&lt;/li&gt;
&lt;li&gt;Meet this goal with high probability (but not with certainty, that
would be &lt;i&gt;hard real-time&lt;/i&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;To achieve this, G1 build upon a number of insights:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Heap doesn't have to be split into contiguous Young and Old generation.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Instead, the heap is split into a member (typically about 2048)
smaller heap regions.
&lt;/li&gt;
&lt;li&gt;Each region may be an Eden region, a Survivor region, or an Old
region.
&lt;/li&gt;
&lt;li&gt;The logical union of all Eden and Survivor regions is the Young
generation, and all the Old regions is the Old generation.
&lt;/li&gt;
&lt;li&gt;This allow the GC to avoid collecting the entire heap at once,
and instead approach the problem &lt;i&gt;incrementally&lt;/i&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Only a subset of the regions, called &lt;b&gt;collection set&lt;/b&gt; will be
considered at a time.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;All the Young regions&lt;/b&gt; are collected during each pause, but
&lt;b&gt;some Old regions&lt;/b&gt; may be included.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;G1 will estimate the amount of &lt;b&gt;live&lt;/b&gt; data in each region.
&lt;ul class="org-ul"&gt;
&lt;li&gt;This is used in building the collection set.
&lt;/li&gt;
&lt;li&gt;The regions that contains the most marbage are collected first.
&lt;/li&gt;
&lt;li&gt;Hence the name: &lt;b&gt;Garbage First&lt;/b&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Steps:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Evaluation Pauses: fully Young.
&lt;/li&gt;
&lt;li&gt;Concurrent Marking
&lt;/li&gt;
&lt;li&gt;Evacuation Pause: Mixed
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;it compacts the heap on-the-go, something the CMS collector only
does during full STW collections.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>gc</category><category>java</category><guid>https://wudong.graceliu.uk/posts/notes/java-hotspot-gc/</guid><pubDate>Thu, 13 Jul 2017 23:00:00 GMT</pubDate></item><item><title>Java Interview Questions</title><link>https://wudong.graceliu.uk/posts/notes/java-interview-questions/</link><dc:creator>Warren Liu</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1"&gt;Java Programming Interview Exposed&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-1"&gt;Writing core algorithm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-2"&gt;How would you implement a bubble sort algorithm?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-3"&gt;How would you implement a insert sort algorithm?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-4"&gt;How would you implement the quicksort algorithm?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-5"&gt;How would you implement the merge sort algorithm?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-6"&gt;Data Structure&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-6-1"&gt;Some notable &lt;b&gt;Collections&lt;/b&gt; methods&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-6-2"&gt;Arrays&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-6-3"&gt;List&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-6-4"&gt;Queue and Deque&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-6-5"&gt;Tree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-6-6"&gt;Set&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-6-7"&gt;Map&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-6-8"&gt;Concurrent Collections&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-7"&gt;Java 8 Stream&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-8"&gt;Design Patterns&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-9"&gt;Datatype&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-1-10"&gt;Libraries&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-interview-questions/#sec-2"&gt;Functional Programming in Java&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;Java Programming Interview Exposed&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;/div&gt;&lt;div id="outline-container-sec-1-1" class="outline-3"&gt;
&lt;h3 id="sec-1-1"&gt;Writing core algorithm&lt;/h3&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-1-2" class="outline-3"&gt;
&lt;h3 id="sec-1-2"&gt;How would you implement a bubble sort algorithm?&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-2"&gt;
&lt;p&gt;
The &lt;b&gt;bubble sort&lt;/b&gt; is extremely simple to describe and implements.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;bubblesort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="n"&gt;numbersSwitched&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="n"&gt;numbersSwitched&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++){&lt;/span&gt;
	    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]){&lt;/span&gt;
		&lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;],&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]);&lt;/span&gt;
		&lt;span class="n"&gt;numbersSwitched&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	    &lt;span class="o"&gt;}&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numbersSwitched&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;




&lt;p&gt;
The worse case, when you want to sort a list that is already sorted in
reverse order, the performance is of \(O(n^2)\): &lt;i&gt;for each iteration, you
are only switching one elements&lt;/i&gt;. The best case is when a list is
already sorted, which has performance of \(O(n)\).
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-3" class="outline-3"&gt;
&lt;h3 id="sec-1-3"&gt;How would you implement a insert sort algorithm?&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-3"&gt;
&lt;p&gt;
The &lt;b&gt;insert sort&lt;/b&gt; is another simple algorithm to describe:
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;insertSort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;sortedList&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;LinkedList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;

&lt;span class="nl"&gt;    originalList:&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;sortedList&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++){&lt;/span&gt;
	    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;sortedList&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;)){&lt;/span&gt;
		&lt;span class="n"&gt;sortedList&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
		&lt;span class="k"&gt;continue&lt;/span&gt; &lt;span class="n"&gt;originalList&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	    &lt;span class="o"&gt;}&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;
	&lt;span class="n"&gt;sortedList&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sortedList&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
The worst-case performance is still \(O(n^2)\).
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-4" class="outline-3"&gt;
&lt;h3 id="sec-1-4"&gt;How would you implement the quicksort algorithm?&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-4"&gt;
&lt;p&gt;
The performance is much more efficient than the bubble sort and insert
sort with an average performance of \(O(n\log(n))\). The worst case is
still \(O(n^2)\). The choice of pivot can make a difference.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;quicksort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Integer&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;lower&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;higher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++){&lt;/span&gt;
	&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;higher&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;sorted&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;quicksort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;sorted&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;sorted&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addAll&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;quicksort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;higher&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sroted&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
It is worth noting that each division of the list and the subsequent
recursive call is &lt;b&gt;independent&lt;/b&gt; of any other sorting necessary, and
could be performed &lt;b&gt;in parallel&lt;/b&gt;.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-5" class="outline-3"&gt;
&lt;h3 id="sec-1-5"&gt;How would you implement the merge sort algorithm?&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-5"&gt;
&lt;p&gt;
This is another divide-and-conquer algorithm: split the list into two,
sort each sublist, and then merge the two list together.
&lt;/p&gt;

&lt;p&gt;
The main code is &lt;b&gt;merging the two lists efficiently&lt;/b&gt;.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;merge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
				  &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;
    &lt;span class="o"&gt;){&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;leftPtr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;rightPtr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;merged&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()+&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leftPtr&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;rightPtr&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()){&lt;/span&gt;
	&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leftPtr&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rightPtr&lt;/span&gt;&lt;span class="o"&gt;)){&lt;/span&gt;
	    &lt;span class="n"&gt;merged&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leftPtr&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
	    &lt;span class="n"&gt;leftPtr&lt;/span&gt;&lt;span class="o"&gt;++;&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;merged&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rightPtr&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
	    &lt;span class="n"&gt;rightPtr&lt;/span&gt;&lt;span class="o"&gt;++;&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leftPtr&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;){&lt;/span&gt;
	&lt;span class="n"&gt;merged&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leftPtr&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
	&lt;span class="n"&gt;leftPtr&lt;/span&gt;&lt;span class="o"&gt;++;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rightPtr&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;){&lt;/span&gt;
	&lt;span class="n"&gt;merged&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rightPtr&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
	&lt;span class="n"&gt;rightPtr&lt;/span&gt;&lt;span class="o"&gt;++;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;mergesort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;leftHalf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;subList&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;leftHalf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;subList&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mergesort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leftHalf&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="n"&gt;mergesort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rightHalf&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Again, merge sort has a performance of \(O(n\log(n)\). Each merge
operation is \(O(n)\), and each recursive call works on only half of the
given list.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-6" class="outline-3"&gt;
&lt;h3 id="sec-1-6"&gt;Data Structure&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-6"&gt;
&lt;/div&gt;&lt;div id="outline-container-sec-1-6-1" class="outline-4"&gt;
&lt;h4 id="sec-1-6-1"&gt;Some notable &lt;b&gt;Collections&lt;/b&gt; methods&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-1-6-1"&gt;
&lt;dl class="org-dl"&gt;
&lt;dt&gt; &lt;code&gt;sort, binarySearch&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;with &lt;b&gt;Comparable&lt;/b&gt; and &lt;b&gt;Comparator&lt;/b&gt;
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;max, min&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;with &lt;b&gt;Comparable&lt;/b&gt; and &lt;b&gt;Comparator&lt;/b&gt;
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;void rotate(List list, int distance)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;Rotates the elements in the
sepcified list by the specified distance. After calling this
method, the element at inde \(i\) will be the element previously at
index \((i - distance) mod list.size()\)
&lt;ul class="org-ul"&gt;
&lt;li&gt;Can be usefully be applied to a sublist: &lt;br&gt;
    &lt;code&gt;Collections.rotate(list.subList(j, k+1), -1);&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;void shuffle(List list, Random rnd)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;randomly permute the
specified list.
&lt;/dd&gt;
&lt;dt&gt; (no term) &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;void reverse(List&amp;lt;?&amp;gt; list)&lt;/code&gt;
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;&amp;lt;T&amp;gt; Comparator&amp;lt;T&amp;gt; reverseOrder(Comparator&amp;lt;T&amp;gt; cmp)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;returns a
comparator that imposes the reverse ordering of the specified
comparator.
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;int frequency(Collection c, Object o)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;return the number of
elements in the specified collection equal to the specified
object.
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;boolean disjoint(Collection c1, Collection c2)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;return true if
two specified collections have no elements in common.
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;List&amp;lt;T&amp;gt; nCopies(int n, T o)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;returns an &lt;b&gt;immutable&lt;/b&gt; list
consisting of \(n\) copies of the specified object.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The newly allocated data object is tiny, containing a single
reference to the data object.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;singleton(T o)&lt;/code&gt;  &lt;/dt&gt;&lt;dd&gt;return an &lt;b&gt;immutable&lt;/b&gt; set containing only the
specified object.
&lt;dl class="org-dl"&gt;
&lt;dt&gt; &lt;code&gt;singletonList(T o)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;an immutable list.
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;singletonMap&amp;lt;K key, V value&amp;gt;&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;returns an &lt;b&gt;immutable&lt;/b&gt; map that
only maps the specified key to the specified value.
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/dd&gt;
&lt;dt&gt; (no term) &lt;/dt&gt;&lt;dd&gt;Wrapper implementations
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;unmodifiableXXX&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;synchronizedXXX&lt;/code&gt;
&lt;/li&gt;
&lt;li id="&amp;lt;code&amp;gt;checkedXXX(Collection&amp;lt;T&amp;gt; c, Class&amp;lt;T&amp;gt; type)&amp;lt;/code&amp;gt;"&gt;returns
a dynamically typesafe view of the specified collection. Any
attemp to insert an element of the wrong type will result in an
immediate ClassCastException.
&lt;ul class="org-ul"&gt;
&lt;li&gt;This can prevent unchecked cast.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;checkedList&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;checkedSet&lt;/code&gt;, &lt;code&gt;checkedSortedSet&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;checkedMap&lt;/code&gt;, &lt;code&gt;checkedSortedMap&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-6-2" class="outline-4"&gt;
&lt;h4 id="sec-1-6-2"&gt;Arrays&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-1-6-2"&gt;
&lt;dl class="org-dl"&gt;
&lt;dt&gt; &lt;code&gt;deepEquals(Object[] a1, Object[] a2), deepHashCode(), deepToString()&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;supporting
nested sub-arrays.
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;fill&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;assigns the value to the specified range of the specified array.
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;parallelPrefix(double[] array, DoubleBinaryOperator op)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;Cumulates,
in parallel, each element of the given array in place, using the
supplied function.
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;sort(T[] array, int fromIndex, int toIndex)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;support sosring in a range.
&lt;/dd&gt;
&lt;dt&gt; &lt;code&gt;stream(T[] array, int startInclusive, int endExclusive)&lt;/code&gt; &lt;/dt&gt;&lt;dd&gt;convert
a stream with the array as its source, also support range.
&lt;/dd&gt;
&lt;dt&gt; (no term) &lt;/dt&gt;&lt;dd&gt;&lt;b&gt;ArrayList&lt;/b&gt;, or &lt;b&gt;ArrayDeque&lt;/b&gt; should be preferable to &lt;b&gt;LinkedList&lt;/b&gt; for
queues/dequeus due to a limited amount of garbage it generates.
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-6-3" class="outline-4"&gt;
&lt;h4 id="sec-1-6-3"&gt;List&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-1-6-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The usage of &lt;code&gt;subList&lt;/code&gt; on the &lt;code&gt;List&lt;/code&gt; interface:
&lt;ul class="org-ul"&gt;
&lt;li&gt;The &lt;b&gt;List&lt;/b&gt; interface now have a &lt;b&gt;subList(int fromIndex, int
toIndex)&lt;/b&gt; function, to return a view of the portion of the list,
inclusive &lt;code&gt;fromIndex&lt;/code&gt;, and exclusive &lt;code&gt;toIndex&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;The returned list is backed by this list, so non-structural
changes in the returned list are reflected in this list, and
vice-versa.
&lt;/li&gt;
&lt;li&gt;The method eliminates the need for explicit range operations. Any
operation that expects a list can be used as a range operation by
passing a subList view. For example, the following idiom removes a
range of element from a list:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;list&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;subList&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;clear&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Some list implementations have restrictions on the elements that
they may contain. For example, some implementations prohibit
&lt;code&gt;null&lt;/code&gt; elements, and some have restrictions on the types of their
elements. Attempting to add an ineligible element throws an
unchecked exception, typically &lt;b&gt;NullPointerException&lt;/b&gt; or
&lt;b&gt;ClassCastException&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;toArray()&lt;/b&gt; will return a new array.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;toArray(T[] a)&lt;/b&gt; will also return a &lt;b&gt;new array&lt;/b&gt;, &lt;i&gt;not the one
specified&lt;/i&gt;, if the size of &lt;code&gt;a&lt;/code&gt; is smaller than the List; it
otherwise return &lt;code&gt;a&lt;/code&gt;, with the remaining of &lt;code&gt;a&lt;/code&gt; set to &lt;code&gt;null&lt;/code&gt; if &lt;code&gt;a&lt;/code&gt;
contains more elements thant the List.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;retainAll(Collection&amp;lt;?&amp;gt; c)&lt;/b&gt; will retains only the elements in
this list that care contained in the specified collection.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ArrayList
&lt;ul class="org-ul"&gt;
&lt;li&gt;ArrayList allows &lt;code&gt;null&lt;/code&gt; elements.
&lt;/li&gt;
&lt;li&gt;Be aware that the array size reallocation in ArrayList is
&lt;b&gt;one-way&lt;/b&gt;; it doesn't shrink if elements are removed from it. If
you have a list that oscillates between many and a few elements,
&lt;b&gt;ArrayList&lt;/b&gt; might not be the best implementation for it.
&lt;/li&gt;
&lt;li&gt;Increase the capacity of an &lt;b&gt;ArrayList&lt;/b&gt; before adding a large
number of elements using &lt;b&gt;ensureCapacity()&lt;/b&gt; operation. This &lt;i&gt;could
reduce the amount of incremental reallocation&lt;/i&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;LinkedList
&lt;ul class="org-ul"&gt;
&lt;li&gt;It is a &lt;b&gt;doubly-linked&lt;/b&gt; list implementation of the &lt;code&gt;List&lt;/code&gt; and
&lt;code&gt;Deque&lt;/code&gt; interface.
&lt;/li&gt;
&lt;li&gt;Operations that index into the list will traverse the list from
&lt;i&gt;the beginning or the end&lt;/i&gt;, whichever is closer to the specified
index.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-1-6-4" class="outline-4"&gt;
&lt;h4 id="sec-1-6-4"&gt;Queue and Deque&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-1-6-4"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;interface &lt;b&gt;Queue&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Queue implementations generally do not allow insertion of &lt;code&gt;null&lt;/code&gt;
elements, although some implementations, such as &lt;b&gt;LinkedList&lt;/b&gt;, do
not prohibit insertion of &lt;code&gt;null&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;Even in the implementations that permit it, &lt;code&gt;null&lt;/code&gt; should not be
inserted into a &lt;b&gt;Queue&lt;/b&gt;, as &lt;code&gt;null&lt;/code&gt; is also used as a &lt;span class="underline"&gt;special return&lt;/span&gt;
value by the &lt;code&gt;poll&lt;/code&gt; method to &lt;i&gt;indicate that the queue contains no
elements&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;Queues provide additional insertion, extraction, and
inspection operations; and each of these methods exists in two
forms: &lt;b&gt;throw exception&lt;/b&gt; or &lt;b&gt;return special value&lt;/b&gt; when the
operation fails.
&lt;/li&gt;
&lt;li&gt;The latter form of the insert operation is designed specifically
for use with &lt;b&gt;capacity-restricted&lt;/b&gt; Queue implementations; in most
implementations, insert operations cannot fail.
&lt;/li&gt;
&lt;li&gt;The two set of methods:
&lt;table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides"&gt;


&lt;colgroup&gt;
&lt;col class="left"&gt;

&lt;col class="left"&gt;

&lt;col class="left"&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th scope="col" class="left"&gt;Operation&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Throws Exception&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Return special value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td class="left"&gt;Insert&lt;/td&gt;
&lt;td class="left"&gt;add(e)&lt;/td&gt;
&lt;td class="left"&gt;offer(e)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;Remove&lt;/td&gt;
&lt;td class="left"&gt;remove()&lt;/td&gt;
&lt;td class="left"&gt;poll()&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;Examine&lt;/td&gt;
&lt;td class="left"&gt;element()&lt;/td&gt;
&lt;td class="left"&gt;peek()&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;Order for Queue is normally &lt;b&gt;FIFO&lt;/b&gt;, except for &lt;b&gt;priority
queues&lt;/b&gt;, which order according to a supplied comparator, and
&lt;b&gt;LIFO&lt;/b&gt; queue(stack).
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;interface &lt;b&gt;Deque&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Pronounced "deck" is an extension of Queue, and allows additon and
removal from either end of the data structure.
&lt;/li&gt;
&lt;li&gt;For each methods defined in &lt;code&gt;Queue&lt;/code&gt;, &lt;code&gt;Deque&lt;/code&gt; defines corresponding
&lt;b&gt;First&lt;/b&gt;, and &lt;b&gt;Last&lt;/b&gt; methods like: &lt;code&gt;addFirst()&lt;/code&gt;, &lt;code&gt;addLast()&lt;/code&gt;,
&lt;code&gt;offerFirst()&lt;/code&gt; and &lt;code&gt;offerLast()&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;descendingIterator()&lt;/b&gt;  from the &lt;code&gt;Deque&lt;/code&gt; interface can be used to
iterate in reverse sequential order.
&lt;/li&gt;
&lt;li&gt;Deques can also be used as &lt;b&gt;LIFO (Last-In-First-Out) stacks&lt;/b&gt;. This
interface should be used &lt;b&gt;in preference to&lt;/b&gt; the &lt;b&gt;legacy&lt;/b&gt; &lt;code&gt;Stack&lt;/code&gt;
class:
&lt;table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides"&gt;


&lt;colgroup&gt;
&lt;col class="left"&gt;

&lt;col class="left"&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th scope="col" class="left"&gt;Stack Method&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Equivalent Deque Method&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td class="left"&gt;push(e)&lt;/td&gt;
&lt;td class="left"&gt;addFirst(e)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;pop()&lt;/td&gt;
&lt;td class="left"&gt;removeFirst(e)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;peed()&lt;/td&gt;
&lt;td class="left"&gt;peekFirst()&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;removeFirstOccurrence(e)&lt;/code&gt; and &lt;code&gt;removeLastOccurrence(e)&lt;/code&gt; is
available on &lt;b&gt;LinkedList&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Apart from &lt;b&gt;LinkedList&lt;/b&gt;, &lt;b&gt;ArrayDeque&lt;/b&gt; is a resizable-array
implementation of the &lt;code&gt;Deque&lt;/code&gt; interface.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;class &lt;b&gt;PriorityQueue&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;An unbounded priority queue based on a &lt;b&gt;priority heap&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;A priority queue does not permit &lt;code&gt;null&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;A priority queue is &lt;b&gt;unbounded&lt;/b&gt;, but has an &lt;i&gt;internal capacity&lt;/i&gt;
governing the size of an array used to store the elements on the
queue.
&lt;/li&gt;
&lt;li&gt;The &lt;b&gt;Iterator&lt;/b&gt; returned from  &lt;code&gt;iterator()&lt;/code&gt; is &lt;b&gt;not&lt;/b&gt; gaurantee to
traverse the elements in any particular order. If ordered
traversal is needed, could use : &lt;code&gt;Arrays.sort(pq.toArray())&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;This class is not threadsafe, &lt;b&gt;PriorityBlockingQueue&lt;/b&gt; is.
&lt;/li&gt;
&lt;li&gt;Heap based priority queue provides \(O(\log(n))\) for enqueing
dequeing methods; linear time for &lt;code&gt;remove()&lt;/code&gt; and &lt;code&gt;contains()&lt;/code&gt; methods
and constant time for the retrieval methods.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;interface &lt;b&gt;BlockingQueue&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;A &lt;b&gt;Queue&lt;/b&gt; that additionally supports operations that &lt;b&gt;wait&lt;/b&gt; for the
queue to become non-empty when retriving an element, and wait for
space to become available in the queue when storing an element.
&lt;/li&gt;
&lt;li&gt;BlockingQueue methods come in four forms:
&lt;table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides"&gt;


&lt;colgroup&gt;
&lt;col class="left"&gt;

&lt;col class="left"&gt;

&lt;col class="left"&gt;

&lt;col class="left"&gt;

&lt;col class="left"&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th scope="col" class="left"&gt;Operation&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Throw Exception&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Special Value&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Blocks&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Times out&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td class="left"&gt;Insert&lt;/td&gt;
&lt;td class="left"&gt;add(e)&lt;/td&gt;
&lt;td class="left"&gt;offer(e)&lt;/td&gt;
&lt;td class="left"&gt;put(e)&lt;/td&gt;
&lt;td class="left"&gt;offer(e, time, unit)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;Remove&lt;/td&gt;
&lt;td class="left"&gt;remove()&lt;/td&gt;
&lt;td class="left"&gt;poll()&lt;/td&gt;
&lt;td class="left"&gt;take()&lt;/td&gt;
&lt;td class="left"&gt;poll(time, unit)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;Examine&lt;/td&gt;
&lt;td class="left"&gt;element()&lt;/td&gt;
&lt;td class="left"&gt;peek()&lt;/td&gt;
&lt;td class="left"&gt;n/a&lt;/td&gt;
&lt;td class="left"&gt;n/a&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;A blockingQueue does not accept null element.
&lt;/li&gt;
&lt;li&gt;BlockingQueue implementations are designed to be used primarily
for &lt;b&gt;producer-consumer&lt;/b&gt; queues, but additionally support the
&lt;b&gt;Collection&lt;/b&gt; interface. However, such operations are in general &lt;b&gt;not&lt;/b&gt;
&lt;i&gt;performed very efficiently&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;drainTo(Collection c)&lt;/b&gt; removes all available elements from this
queue and adds them to the given collection. This operation may be
more efficient than repeatdly polling thes queue.
&lt;/li&gt;
&lt;li&gt;BlockingQueue implementations are thread. However, the &lt;b&gt;bulk&lt;/b&gt;
Collection operations &lt;code&gt;addAll&lt;/code&gt;, &lt;code&gt;containsAll&lt;/code&gt;, &lt;code&gt;retainAll&lt;/code&gt; and &lt;code&gt;removeAll&lt;/code&gt;
are &lt;b&gt;not&lt;/b&gt; necessarily &lt;i&gt;performed atomically&lt;/i&gt; unless specified
otherwise in an implementation.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Memory consistency effects&lt;/b&gt;: As with other concurrent collections,
actions in a thread prior to &lt;b&gt;placing an object&lt;/b&gt; into a
BlockingQueue &lt;b&gt;happen-before&lt;/b&gt; actions subsequent to the &lt;b&gt;access&lt;/b&gt; or
&lt;b&gt;removal&lt;/b&gt; of that element from the BlockingQueue in another thread.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;LinkedBlockingQueue&lt;/b&gt; is an optionally-bounded blocking queue. The
optional capacity serves as a way to prevent excessive queue
expansion, which default to &lt;code&gt;Integer.MAX_VALUE&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ArrayBlockingQueue&lt;/b&gt; is a bounded blocking queue backed by an
array. The capacity cannot be changed once created.
&lt;ul class="org-ul"&gt;
&lt;li&gt;This class supports an optional &lt;b&gt;fairness policy&lt;/b&gt; for &lt;b&gt;ordering&lt;/b&gt;
waiting producer and consumer threads. &lt;i&gt;By default, the ordering
is not guaranteed&lt;/i&gt;. When setting, the access granted in &lt;b&gt;FIFO&lt;/b&gt; order.
&lt;/li&gt;
&lt;li&gt;Fairness generally decreases &lt;i&gt;throughput&lt;/i&gt; but reduces
&lt;i&gt;variability&lt;/i&gt; and avoids &lt;i&gt;starvation&lt;/i&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;SynchronousQueue&lt;/b&gt; is a blocking queue in which each insert
operation must &lt;b&gt;wait for&lt;/b&gt; a corresponding remove operation by
another thread, and vice versa.
&lt;ul class="org-ul"&gt;
&lt;li&gt;A SynchronousQueue doesn't have any internal capacity, not even
a capacity of one.
&lt;/li&gt;
&lt;li&gt;Cannot peek because element is only present when you try to
remove it; you cannot insert an element (using any method)
unless another thread is trying to remove it.
&lt;/li&gt;
&lt;li&gt;its &lt;code&gt;isEmpty()&lt;/code&gt; will always return &lt;code&gt;true&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;Synchronous queue are similar to &lt;b&gt;rendezvous channels&lt;/b&gt; used in
&lt;b&gt;CSP&lt;/b&gt; and &lt;b&gt;Ada&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;They are suited for &lt;b&gt;handoff designs&lt;/b&gt;, in which an object running
in one thread must &lt;i&gt;sync up&lt;/i&gt; with an object running in another
thread in order to &lt;span class="underline"&gt;hand it some information, event, or task&lt;/span&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;interface &lt;b&gt;TransferQueue&lt;/b&gt; extends &lt;b&gt;BlockingQueue&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;A &lt;b&gt;BlockingQueue&lt;/b&gt; in which producers may wait for consumer to
receive elements.
&lt;/li&gt;
&lt;li&gt;A &lt;b&gt;TransferQueue&lt;/b&gt; may be useful for example in message passing
applications in which producers sometimes (using method
&lt;b&gt;transfer(E)&lt;/b&gt;) await receipt of elements by consumers invoking take
or poll, while at other times enqueue elements (via method put)
without waiting for receipt.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;tryTransfer&lt;/b&gt; can be used for Non-blocking and time-out for way.
&lt;/li&gt;
&lt;li&gt;A &lt;b&gt;TransferQueue&lt;/b&gt; can also be quired, with &lt;b&gt;hasWaitingComsumer()&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;class &lt;b&gt;LinkedTransferQueue&lt;/b&gt; implements this interface.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;i&gt;the size method is &lt;b&gt;NOT&lt;/b&gt; a constant-time operation&lt;/i&gt;: Because of
the asynchronous nature of these queues, determining the current
number of elements requires a traversal of the elements, and so
may report inaccurate results if this collection is modified
during traversal.
&lt;/li&gt;
&lt;li&gt;bulk operations are &lt;b&gt;not&lt;/b&gt; guaranteed to be performed atomically.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;TransferQueue&lt;/b&gt; is more generic and useful than
&lt;b&gt;SynchronousQueue&lt;/b&gt;, allowing you to flexibly decide whether to use
normal BlockingQueue semantics or a guaranteed hand-off.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Much better performance than &lt;b&gt;SynchronousQueue&lt;/b&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;class DelayQueue&amp;lt;E extends Delayed&amp;gt; implements &lt;b&gt;BlockingQueue&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;An unbounded blocking queue of Delayed elements, in which an
element can only be taken when its delay has expired.
&lt;/li&gt;
&lt;li&gt;The head of the queue is the Delayed element whose delay expired
furthest in the past.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-1-6-5" class="outline-4"&gt;
&lt;h4 id="sec-1-6-5"&gt;Tree&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-1-6-5"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Search with &lt;b&gt;binary search tree&lt;/b&gt;:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;search&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;E&lt;/span&gt; &lt;span class="n"&gt;toFind&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toFind&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;value&lt;/span&gt;&lt;span class="o"&gt;)){&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toFind&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareTo&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;)&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;left&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;search&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toFind&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;search&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toFind&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Inserting value into a binary search tree:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;insert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;E&lt;/span&gt; &lt;span class="n"&gt;toInsert&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toInsert&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareTo&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;value&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
	&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;TreeNode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toInsert&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;insert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toInsert&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;TreeNode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toInsert&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;insert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toInsert&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;
Inserting in this manner may produce an &lt;b&gt;unbalanced tree&lt;/b&gt;.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;Removing from a binary search tree:
&lt;ol class="org-ol"&gt;
&lt;li&gt;Search for the node;
&lt;/li&gt;
&lt;li&gt;If the node have no child, just remove it;
&lt;/li&gt;
&lt;li&gt;If the node have only one child, remove the node, and link the
node's parent and child.
&lt;/li&gt;
&lt;li&gt;If the node have two children:
&lt;ol class="org-ol"&gt;
&lt;li&gt;Find a minimu value in the right subtree (or maximum value
in the left three);
&lt;/li&gt;
&lt;li&gt;Replace the value of the node to be removed with found minimum;
&lt;/li&gt;
&lt;li&gt;Remove the minimum from its right tree; notice that the
minimum has no left child, therefore, its removal may result
in first or second cases only.
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;remove&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BSTNode&lt;/span&gt; &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;value&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
	    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;remove&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="k"&gt;else&lt;/span&gt;
	    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;value&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
	    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;remove&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="k"&gt;else&lt;/span&gt;
	    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;minValue&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
	    &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;remove&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;value&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;left&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;right&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
	    &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;right&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
	&lt;span class="o"&gt;}&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;minValue&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;minValue&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;A specific implementation of binary tree is called &lt;b&gt;&lt;a href="http://www.geeksforgeeks.org/avl-tree-set-1-insertion/"&gt;AVL Tree&lt;/a&gt;&lt;/b&gt;
(self-balancing) enforces that, for any node, the &lt;i&gt;difference in
depth for each child is at most one&lt;/i&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;After each insertion or deletion of a node, the tree checks if
it is still balanced, and subsequently &lt;b&gt;rotates&lt;/b&gt; the nodes of
values where the property of the &lt;b&gt;AVL Tree&lt;/b&gt; doesn't not hold.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;&lt;a href="http://www.geeksforgeeks.org/red-black-tree-set-1-introduction-2/"&gt;Red-Black Tree&lt;/a&gt;&lt;/b&gt; is another self-balancing binary search tree with
one extra attribute for each node: &lt;b&gt;the colour&lt;/b&gt;, being either red
or black:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Properties:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Root of the tree is always black.
&lt;/li&gt;
&lt;li&gt;There are no two adjacent red nodes (A red node cannot have a
red parent or red child)
&lt;/li&gt;
&lt;li&gt;Every path from &lt;i&gt;root to a NULL&lt;/i&gt; node has same number of black
node.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The height of a Red-Black Tree is always \(O(\log(n))\), i.e. it is a
balanced tree.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Comparison of AVL Tree and Red-Black Tree:
&lt;ul class="org-ul"&gt;
&lt;li&gt;AVL Tree is more balanced - better for search
&lt;/li&gt;
&lt;li&gt;AVL Tree's deletion/insertion may involved more
roations. Red-Black tree is better for insert/deletion.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;When a tree is balanced, search/insert/delete has performance of
\(O(\log(n))\).
&lt;/li&gt;
&lt;li&gt;Bineary trees can be used for &lt;b&gt;Binary Heap&lt;/b&gt;, which is a balanced
tree with the property that children are &lt;b&gt;greater than&lt;/b&gt; their parent.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The heat property defines that the smallest element in the tree is
at the root. Heaps are especially useful for priority queues, or
any time you require quick access to the smallest element of a collection.
&lt;/li&gt;
&lt;li&gt;A heap is not a sorted structure and can be regarded as
partially ordered.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Insert&lt;/b&gt;: the new element is initially appended to the right
most leaf node. The heap property is repaired by comparing the
added element with its parent and moving the added element up a
level by swapping with parent. It is repeated until the parent
is smaller or equal to the element. Performance is \((\log(n))\).
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;DeleteMin&lt;/b&gt;: Remove the root and replace it the right most
leaf. Then compare with its &lt;b&gt;smaller&lt;/b&gt; child, and swapping until the
heap property is satisfied. Performance is \((\log(n))\).
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;HeapSort&lt;/b&gt;: build a heap and turn it into a sorted list by
calling &lt;b&gt;deleteMin&lt;/b&gt; repeatly. It has performance of \((n\log(n))\).
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-6-6" class="outline-4"&gt;
&lt;h4 id="sec-1-6-6"&gt;Set&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-1-6-6"&gt;
&lt;p&gt;
For each of the Map implementation visited ealier, there is an
equvialent Set implementation:
&lt;/p&gt;
&lt;dl class="org-dl"&gt;
&lt;dt&gt; HashSet &lt;/dt&gt;&lt;dd&gt;implemented based on HashMap with dummy values (same
Object is used for every value).
&lt;/dd&gt;
&lt;dt&gt; TreeSet &lt;/dt&gt;&lt;dd&gt;based on a TreeMap instance.
&lt;/dd&gt;
&lt;dt&gt; (no term) &lt;/dt&gt;&lt;dd&gt;LinkedHashSet:: based on a LinkedHashMap instance.
&lt;/dd&gt;
&lt;dt&gt; (no term) &lt;/dt&gt;&lt;dd&gt;&lt;b&gt;SortedSet&lt;/b&gt; and &lt;b&gt;NavigableSet&lt;/b&gt; implemented by &lt;b&gt;TreeSet&lt;/b&gt;.
&lt;/dd&gt;
&lt;dt&gt; (no term) &lt;/dt&gt;&lt;dd&gt;&lt;b&gt;Set &amp;lt;E&amp;gt; Collections.newSetFromMap(Map&amp;lt;E, Boolean&amp;gt; map)&lt;/b&gt; returns a
set backed by the specified map. The resulting set displays the same
ordering, concurrency, and performance characterstics as the backing
map.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Useful to construct Set that doesn't have corresponding Set
implementation of a Map, like &lt;b&gt;WeakHashSet&lt;/b&gt;, or
&lt;b&gt;ConcurrentHashMap&lt;/b&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-6-7" class="outline-4"&gt;
&lt;h4 id="sec-1-6-7"&gt;Map&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-1-6-7"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;HashMap
&lt;ul class="org-ul"&gt;
&lt;li&gt;The implementation permits &lt;code&gt;null&lt;/code&gt; values and &lt;code&gt;null&lt;/code&gt; key.
&lt;/li&gt;
&lt;li&gt;An instance of HashMap has two parameters that affect its
performance: &lt;b&gt;initial capacity&lt;/b&gt; and &lt;b&gt;load factor&lt;/b&gt;. The capacity is
the &lt;i&gt;number of buckets&lt;/i&gt; in the hash table. The load factor is a
measure of how full the hash table is allowed to get before its
capacity is automatically increased.
&lt;/li&gt;
&lt;li&gt;When the number of entries in the hash table
&lt;code&gt;loadFactor*currentCapacity&lt;/code&gt;, the hash table is &lt;b&gt;rehashed&lt;/b&gt; so that
the hash table has approximately &lt;b&gt;twice&lt;/b&gt; the number of buckets.
&lt;/li&gt;
&lt;li&gt;When construct a new HashMap, a &lt;b&gt;load factor&lt;/b&gt; between [0, 1] can
be specified: &lt;code&gt;public HashMap(int initialCapacity, float
    loadFactory)&lt;/code&gt;. The default load factor is 0.75.
&lt;/li&gt;
&lt;li&gt;If the initial capacity is greater than the maximum number of
entries divided by the load factor, no rehash operations will ever
occur.
&lt;/li&gt;
&lt;li&gt;If many mappings are to be stored in a HashMap instance, creating
it with a sufficiently large capacity will allow the mappings to
be stored more efficiently than letting it perform automatic
rehashing as needed to grow the table.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;keySet()&lt;/b&gt;, &lt;b&gt;values()&lt;/b&gt; and &lt;b&gt;entrySet()&lt;/b&gt; all provide &lt;b&gt;view&lt;/b&gt; &lt;i&gt;backed&lt;/i&gt;
by the map. Map's changes are reflected in the set, and
vise-verse. If elements are removed from the view, the
corresponding mappings are &lt;b&gt;removed&lt;/b&gt; from the map.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;LinkedHashMap&lt;/b&gt; is similar to HashMap but have an added property
that iterating over the &lt;b&gt;keys&lt;/b&gt; will be in the same order as
&lt;b&gt;insertion&lt;/b&gt;. However, this is the most expensive JDK collection in
terms of memory consumption per element.
&lt;/li&gt;
&lt;li id="interface &amp;lt;b&amp;gt;SortedMap&amp;lt;/b&amp;gt;"&gt;A map that provides a total ordering on its
keys.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The order is reflected when iterating over the sorted map's
collection views (returned by &lt;code&gt;entrySet&lt;/code&gt;, &lt;code&gt;keySet&lt;/code&gt;, and &lt;code&gt;values&lt;/code&gt; methods).
&lt;/li&gt;
&lt;li&gt;Implements by &lt;b&gt;TreeMap&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li id="interface &amp;lt;b&amp;gt;NavigableMap&amp;lt;/b&amp;gt;"&gt;A &lt;b&gt;SortedMap&lt;/b&gt; extended with navigation
methods returning the closest matches for given search target.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;lowEntry&lt;/code&gt;, &lt;code&gt;flowEntry&lt;/code&gt;, &lt;code&gt;ceilingEntry&lt;/code&gt;, &lt;code&gt;higherEntry&lt;/code&gt; returns
&lt;code&gt;Map.Entry&lt;/code&gt; objects whose key respectively &lt;i&gt;less then&lt;/i&gt;, &lt;i&gt;less than
or equal&lt;/i&gt;, &lt;i&gt;greater than or equal&lt;/i&gt;, &lt;i&gt;greater than&lt;/i&gt; the given key.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;headMap(until)&lt;/code&gt;, &lt;code&gt;tailMap(from)&lt;/code&gt;, and &lt;code&gt;subMap(from, to)&lt;/code&gt; return
subset of the mapping entries given the search condition.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;TreeMap implements both &lt;b&gt;SortedMap&lt;/b&gt; and &lt;b&gt;NavigableMap&lt;/b&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;It uses a &lt;b&gt;red-black tree&lt;/b&gt; with each node in the tree is a
key-value pair.
&lt;/li&gt;
&lt;li&gt;Each elements put into the TreeMap rebalanced the tree.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;EnumMap - a map with enum keys
&lt;/li&gt;
&lt;li id="&amp;lt;b&amp;gt;IdentityHashMap&amp;lt;/b&amp;gt;"&gt;it a special version of map. It &lt;b&gt;violates&lt;/b&gt; the
Map general contract : it compares references using &lt;code&gt;==&lt;/code&gt; instead of
&lt;code&gt;Object.equals&lt;/code&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Useful for various graph traversal algorithms: you may easily
store already processed nodes in the &lt;b&gt;IdentityHashMap&lt;/b&gt; along with
some node-related data.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li id="&amp;lt;b&amp;gt;WeakHashMap&amp;lt;/b&amp;gt;"&gt;keeps its key with WeakReference, which is subject to
GC. Values are, however, stored using strong
reference.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Useful for data cache implementations.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-6-8" class="outline-4"&gt;
&lt;h4 id="sec-1-6-8"&gt;Concurrent Collections&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-1-6-8"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;CopyOnWriteArrayList&lt;/b&gt;: making a copy of underlying array on each
update. Should be used when traversal seriously outnumbering
updates.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Useful for listener/observers.
&lt;/li&gt;
&lt;li&gt;No synchronization is necessary, even during iteration.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;CopyOnWriteArraySet&lt;/b&gt;: based on a copy-on-write array.
&lt;/li&gt;
&lt;li id="&amp;lt;b&amp;gt;ConcurrentHashMap&amp;lt;/b&amp;gt;"&gt;
&lt;/li&gt;&lt;li id="&amp;lt;b&amp;gt;ConcurrentLinkedQueue&amp;lt;/b&amp;gt;"&gt;A unbounded thread-safe queue based on
linked nodes.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ConcurrentSkipListMap&lt;/b&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;div id="outline-container-sec-1-7" class="outline-3"&gt;
&lt;h3 id="sec-1-7"&gt;Java 8 Stream&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-7"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The processing Order
&lt;ul class="org-ul"&gt;
&lt;li&gt;Intermediate operations will only be executed when a terminal
operation is present.
&lt;/li&gt;
&lt;li&gt;Each elements in the stream moves along the chain vertically, not
all elements processed together in each intermediate operations.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Reusing Streams.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Java 8 stream cannot be reused.
&lt;/li&gt;
&lt;li&gt;As soon as you call any terminal operation, the stream is closed.
&lt;/li&gt;
&lt;li&gt;We have to create a new stream chain for every terminal operation
we want to execute.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Intermediate operations.
&lt;table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides"&gt;


&lt;colgroup&gt;
&lt;col class="left"&gt;

&lt;col class="left"&gt;

&lt;col class="left"&gt;

&lt;col class="left"&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th scope="col" class="left"&gt;Function&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Preserve count&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Preserve type&lt;/th&gt;
&lt;th scope="col" class="left"&gt;Perserve order&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td class="left"&gt;&lt;code&gt;map&lt;/code&gt;&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;td class="left"&gt;N&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;&lt;code&gt;filter&lt;/code&gt;&lt;/td&gt;
&lt;td class="left"&gt;N&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;&lt;code&gt;distinct&lt;/code&gt;&lt;/td&gt;
&lt;td class="left"&gt;N&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;&lt;code&gt;sorted&lt;/code&gt;&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;td class="left"&gt;N&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="left"&gt;&lt;code&gt;peek&lt;/code&gt;&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;td class="left"&gt;Y&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;

&lt;li&gt;&lt;b&gt;Collectors&lt;/b&gt; : transform the elements of the stream into a different
kind of result.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;toList&lt;/code&gt;, &lt;code&gt;toSet&lt;/code&gt;, &lt;code&gt;toMap&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;averagingInt&lt;/code&gt;, &lt;code&gt;summarizingInt&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;joining&lt;/code&gt;: accepts a delimiter and optional prefix and suffix.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;One important thing to note is that parallel streams achieve
parallelism through threads using the existing common
&lt;b&gt;ForkJoinPool&lt;/b&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;As a result, there are possible complications:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;a href="https://zeroturnaround.com/rebellabs/java-parallel-streams-are-bad-for-your-health/"&gt;https://zeroturnaround.com/rebellabs/java-parallel-streams-are-bad-for-your-health/&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;The common pool is upper limited (can be changed with a system
property) with &lt;code&gt;Runtime.availableProcessors()&lt;/code&gt;, it is possible
to block all the threads in it and thus exhaust the pool.
&lt;/li&gt;
&lt;li&gt;If you know the Job in the parallel stream is going to block for
some time, it will be better to use a &lt;code&gt;interface
      ForkJoinPool.ManagedBlocker&lt;/code&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Parallel streams are &lt;b&gt;unpredictable&lt;/b&gt; and complex to use correctly.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Almost any use of parallel streams can affect the performance of
other &lt;b&gt;unrelated&lt;/b&gt; system components in an &lt;b&gt;unpredictable way&lt;/b&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;

&lt;li&gt;&lt;b&gt;Starvation&lt;/b&gt; describes a situation where a thread is unable to gain
regular access to shared resources and is unable to make
progress.
&lt;ul class="org-ul"&gt;
&lt;li&gt;This happens when shared resources are made unavailable for long
periods by "greedy" threads.
&lt;/li&gt;
&lt;li&gt;For example, suppose an object provides a synchronized method
that often takes a long time to return.
&lt;/li&gt;
&lt;li&gt;If one thread invokes this method frequently, other threads that
also need frequent synchronized access to the same object will
often be blocked.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Livelock&lt;/b&gt; A thread often acts in response to the action of another
thread. If the other thread's action is also a response to the
action of another thread, then livelock may result.
&lt;ul class="org-ul"&gt;
&lt;li&gt;As with deadlock, livelocked threads are unable to make further
progress.
&lt;/li&gt;
&lt;li&gt;However, the threads are not blocked â they are simply too busy
responding to each other to resume work.
&lt;/li&gt;
&lt;li&gt;This is comparable to two people attempting to pass each other
in a corridor: Alphonse moves to his left to let Gaston pass,
while Gaston moves to his right to let Alphonse pass. Seeing
that they are still blocking each other, Alphone moves to his
right, while Gaston moves to his left. They're still blocking
each other, soâ¦
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-8" class="outline-3"&gt;
&lt;h3 id="sec-1-8"&gt;Design Patterns&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-8"&gt;
&lt;dl class="org-dl"&gt;
&lt;dt&gt; Strategy Pattern &lt;/dt&gt;&lt;dd&gt;enables you to defer decisions about which
implementation to use until &lt;i&gt;run time&lt;/i&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The Spring Framework uses an XML file to construct objects and
their dependencies, which are read at runtime, allowing a quick
change between implementations without any need for recompilation.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Template Pattern &lt;/dt&gt;&lt;dd&gt;is used to defer to delegate some, or all steps
of an algorithm to a subclass. Common behaviour can be defined in
a superclass, then specific variants are written in a subclass.
&lt;/dd&gt;
&lt;dt&gt; Decorator Pattern &lt;/dt&gt;&lt;dd&gt;enables you to change or configure the
functionality of a specific object.
&lt;ul class="org-ul"&gt;
&lt;li&gt;It takes an instance of same abstract/interface type which adds
additional behaviour.
&lt;/li&gt;
&lt;li&gt;Java's IO class use the Decorator Pattern extensively.
&lt;/li&gt;
&lt;li&gt;java.util.Collections, the &lt;code&gt;checkedXXX()&lt;/code&gt;, &lt;code&gt;synchronizedXXX()&lt;/code&gt; and
&lt;code&gt;unmodifiableXXX()&lt;/code&gt; methods.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Flyweight Pattern &lt;/dt&gt;&lt;dd&gt;can be used when you have several objects, and
many may represent the same value. In these instances, it can be
possbile to share the values as long as the objects are immutable.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;b&gt;Integer&lt;/b&gt; class is an implementation of the flyweight pattern:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;Integer&lt;/span&gt; &lt;span class="nf"&gt;valueOf&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;IntegerCache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;high&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="mi"&gt;127&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;IntegerCache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;low&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;IntegerCache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;high&lt;/span&gt;&lt;span class="o"&gt;){&lt;/span&gt;
	&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;IntegerCache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;(-&lt;/span&gt;&lt;span class="n"&gt;IntegerCache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;low&lt;/span&gt;&lt;span class="o"&gt;)];&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;
The default range of the cache is -128 to 127. The cache is
initialized in a static block and is created the first time an
Integer is referenced.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;Another implementation of the Flyweight Pattern is called &lt;b&gt;Null
Object Pattern&lt;/b&gt;, which uses a flyweight object to represent
&lt;code&gt;null&lt;/code&gt;. For example in tree implementation, a &lt;b&gt;NullObject&lt;/b&gt; can be
used to represent non-children.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Singleton &lt;/dt&gt;&lt;dd&gt;using &lt;b&gt;Enum&lt;/b&gt;, JVM will guarantee that only one
instance will ever be created.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;enum&lt;/span&gt; &lt;span class="n"&gt;SingletonEnum&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;INSTANCE&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;singletonMethod&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
	&lt;span class="c1"&gt;//operation here.&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Singletons work best in specialized applications such as GUI on
a desktop or mobile application. Or you know you will not have
many concurrent users.
&lt;/li&gt;
&lt;li&gt;If you are building large, scalable server applications,
singleton objects are often the source of many performance
bottlenecks.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;java.lang.Runtime#getRuntime()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;java.awt.Desktop#getDesktop()&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Abstract Factory &lt;/dt&gt;&lt;dd&gt;creational methods returning the &lt;b&gt;factory
itself&lt;/b&gt; which in turn can be used to create other abstract types.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;javax.xml.parsers.DocumentBuilderFactory#newInstance()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;javax.xml.transform.TransformerFactory#newInstance()&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Factory Method &lt;/dt&gt;&lt;dd&gt;Creational methods returning an implementation of
an abstract/interface type.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;java.util.Calendar#getInstance()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;java.util.ResourceBundle#getBundle()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;java.text.NumberFormat#getInstance()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;java.nio.charset.Charset#forName()&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; (no term) &lt;/dt&gt;&lt;dd&gt;Builder
&lt;ul class="org-ul"&gt;
&lt;li&gt;The Implementations of &lt;b&gt;java.lang.Appendable&lt;/b&gt; are
builders. &lt;b&gt;Appendable&lt;/b&gt; is an object which char sequences
(&lt;b&gt;java.lang.CharSequence&lt;/b&gt;) and values can be appended. It must be
implemented by class whose instances are intended to receive
formatted output from a Formatter.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Prototype &lt;/dt&gt;&lt;dd&gt;Creational methods returning a different instance of
itself with same properties
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;java.lang.Object#clone()&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Chain of Responsibility &lt;/dt&gt;&lt;dd&gt;Behaviour methods which indirectly
invokes the same method in another implementation of same
abstract/interface type &lt;b&gt;in a queue&lt;/b&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;java.util.logging.Logger#log()&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;javax.servlet.Filter#doFilter()&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; State &lt;/dt&gt;&lt;dd&gt;Behaviour methods which changes its behaviour depending on
the instance's state, which can be controlled externally.
&lt;ul class="org-ul"&gt;
&lt;li&gt;provides behaviour to an object so that it can be changed during
runtime.
&lt;/li&gt;
&lt;li&gt;Very similar to &lt;b&gt;Bridge&lt;/b&gt; pattern but intention is different:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Bridge is structural: hide data from client, and client only
aware of the handle.
&lt;/li&gt;
&lt;li&gt;State is behavioral: provides &lt;i&gt;flexible behavior&lt;/i&gt; of owning object
and client would be aware of &lt;b&gt;both&lt;/b&gt; owning object and state objects.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Bridge &lt;/dt&gt;&lt;dd&gt;decouples an abstraction from the implementation of its
abstract operations, so that abstraction and its
implementation can vary &lt;b&gt;independently&lt;/b&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;AWT: provides an abstract layer which maps onto the native OS.
&lt;/li&gt;
&lt;li&gt;JDBC
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Template method &lt;/dt&gt;&lt;dd&gt;allows subclasses to override parts of the method
without rewriting it; also allow you to control whichh operations
subclasses are required to override.
&lt;/dd&gt;
&lt;dt&gt; Adapter &lt;/dt&gt;&lt;dd&gt;convert the interface of a class into another interface
clients expect.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;java.io.InputStreamReader&lt;/code&gt;, &lt;code&gt;java.io.OutputStreamWriter&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt; Memento &lt;/dt&gt;&lt;dd&gt;capture the internal state of an object without violating
encapsulation and thus providing a mean for restoring the
object into initial state when needed.
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;java.util.Date&lt;/code&gt;: internally represented by a long value.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;java.io.Serializable&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-9" class="outline-3"&gt;
&lt;h3 id="sec-1-9"&gt;Datatype&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-9"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Two's Complement representation
&lt;ul class="org-ul"&gt;
&lt;li&gt;Storage of binary values of short, int, and long.
&lt;/li&gt;
&lt;li&gt;The negative equivalent of possitive value is calculated by
applying a binary NOT and then add 1.
&lt;/li&gt;
&lt;li&gt;There is only one value for zero: there is no concept of a
negative zero.
&lt;/li&gt;
&lt;li&gt;Which in tun, means the system can store one extra negative value.
&lt;/li&gt;
&lt;li&gt;The most negative number(&lt;b&gt;Integer.MIN&lt;sub&gt;VALUE&lt;/sub&gt;&lt;/b&gt;), has the most
significant bit of 1, and all remaining bits are zeros.
&lt;/li&gt;
&lt;li&gt;The most negative number's abs() will fail, no corresponding
positive value for it.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li id="BigInteger"&gt;Immutable &lt;b&gt;arbitrary-precision&lt;/b&gt; integers.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Effectively unbounded.
&lt;/li&gt;
&lt;li&gt;Has all the methods that can would normally applied on an Integer.
&lt;/li&gt;
&lt;li&gt;All operations behave as if BigIntegers were represented in
&lt;b&gt;two's-complement&lt;/b&gt; notation (like Java's primitive integer types).
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;gcd(BigInteger val)&lt;/code&gt;: return the greatest common divisor.
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isProbablyPrime()&lt;/code&gt; : return ture if is probably prime, false if
it definitely composite.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li id="BigDecimal"&gt;Immutable &lt;b&gt;arbitrary-precision&lt;/b&gt; decimal numbers.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;AtomicLong&lt;/b&gt; and &lt;b&gt;AtomicInteger&lt;/b&gt; are also subclass of &lt;b&gt;Number&lt;/b&gt;.
&lt;/li&gt;
&lt;li id="&amp;lt;b&amp;gt;String&amp;lt;/b&amp;gt;"&gt;&lt;ul class="org-ul"&gt;
&lt;li&gt;String constructor which take byte or char array, will copy the
array for the String.
&lt;/li&gt;
&lt;li&gt;static methods
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;format(String format, Object... args)&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;join(CharSequence delimiter, CharSequence... elements)&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;String intern: When the class is loaded by the JVM, it holds all
the literals in a constants pool. Any repettion of a String
literal can be referenced from the same constant in the pool.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The String intern pool is not just open to compile-time String
literals; any String instance can be added to this pool with the
intern() method.
&lt;/li&gt;
&lt;li&gt;When the intern method is invoked, if the pool already contains
a string equal to this String object as determined by the
&lt;code&gt;equals(Object)&lt;/code&gt; method, then the string from the pool is
returned. Otherwise, this String object is added to the pool and
a reference to this String object is returned.
&lt;/li&gt;
&lt;li&gt;It follows that for any two strings &lt;code&gt;s&lt;/code&gt; and &lt;code&gt;t&lt;/code&gt;, &lt;code&gt;s.intern() ==
      t.intern()&lt;/code&gt; is &lt;code&gt;true&lt;/code&gt; if and only if &lt;code&gt;s.equals(t)&lt;/code&gt; is &lt;code&gt;true&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;In Java 6, interned strings were stored in the &lt;b&gt;PermGen&lt;/b&gt; â the
&lt;b&gt;fixed size&lt;/b&gt; part of heap mainly used for storing loaded classes
and string pool. using intern() might lead to out of memory in
the &lt;b&gt;PermGen&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;Since Java 7: the string pool was relocated to the heap.
&lt;/li&gt;
&lt;li&gt;String pool values can be GC as well.
&lt;/li&gt;
&lt;li&gt;String pool is implemented as a HashMap, with its key being its
hashcode. and the map size can be set with &lt;code&gt;-XX:StringTableSize&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;The String constant pool is an implementation of the &lt;b&gt;Flyweight&lt;/b&gt;
      pattern.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Exception
&lt;ul class="org-ul"&gt;
&lt;li&gt;the author's opition is to favor runtime exceptions and be
explicit in any documentation as to what exactly may be thrown to
any clients calling that method.
&lt;/li&gt;
&lt;li&gt;Modern languages such as &lt;b&gt;Scala&lt;/b&gt; have stepped away from checked
exceptions, and have only runtime exceptions.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Why do fields that are private also need to be marked as final to
make them immutable?
&lt;ul class="org-ul"&gt;
&lt;li&gt;The private field can be manipulated using the &lt;b&gt;Reflection
API&lt;/b&gt;. Reflection API has the ability to access and mutate all
fields, regardless of their visibility.
&lt;/li&gt;
&lt;li&gt;The final modifier instructs the JVM that no modifications are
allowed on that field at all.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-10" class="outline-3"&gt;
&lt;h3 id="sec-1-10"&gt;Libraries&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-10"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;It is advisiable to use the &lt;b&gt;expected&lt;/b&gt; parameter on the &lt;b&gt;@Test&lt;/b&gt;
annotation sparingly. The most reliable tests using this parameter
have only one line in the method body: the line that should throw
the exception.
&lt;/li&gt;
&lt;li&gt;How can a test fail if it does not complete quickly enough?
&lt;ul class="org-ul"&gt;
&lt;li&gt;The @Test annotation can take a &lt;b&gt;timeout&lt;/b&gt; parameter, which takes a
value of type long.
&lt;/li&gt;
&lt;li&gt;If the test is running for longer than the timeout specified, the
test fails.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-2" class="outline-2"&gt;
&lt;h2 id="sec-2"&gt;Functional Programming in Java&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The &lt;code&gt;Iterable&lt;/code&gt; interface has been enhanced in Java 8 with a special
method &lt;code&gt;forEach()&lt;/code&gt;, which accept a &lt;code&gt;Consumer&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;However, once &lt;code&gt;forEach&lt;/code&gt; starts, we cannot break out of the
iteration.
&lt;/li&gt;
&lt;li&gt;Thus this style is useful in the common case where we want to
process each element in a collection.
&lt;/li&gt;
&lt;li&gt;Lambda function with inferred parameters: the parameters are
&lt;code&gt;non-final&lt;/code&gt;.
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forEach&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;span class="c1"&gt;//or, with the inferred type, cannot specify final here.&lt;/span&gt;
&lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forEach&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;span class="c1"&gt;//or.&lt;/span&gt;
&lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forEach&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;In Java you can use lambdas and method references when any &lt;b&gt;SAM&lt;/b&gt;
  (single abstract method) interface is expected.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Lambdas can be freely converted to SAM Types.
&lt;ul class="org-ul"&gt;
&lt;li&gt;Example:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Predicate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;startsWithN&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;startsWith&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"N"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="c1"&gt;//or using a Lexical scoping with closure.&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;Predicate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;checkIfStartsWith&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;letter&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;startsWith&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;letter&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="c1"&gt;//or with *Function* Interface.&lt;/span&gt;
&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Function&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Predicate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;startsWithLetter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
    &lt;span class="n"&gt;letter&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;startsWith&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;letter&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;This can also help with reuse of lambda expression, if it is
used multiple times.
&lt;/li&gt;
&lt;li&gt;From within a lambda expression we can only access local
variables that are &lt;code&gt;final&lt;/code&gt; or &lt;code&gt;effectively final&lt;/code&gt; in the
enclosing scope.
&lt;/li&gt;
&lt;li&gt;A lambda expression may be invoked right away, or it may be
invoked lazily or from multiple thread.
&lt;/li&gt;
&lt;li&gt;To avoid race conditions, the local variables we access in the
enclosing scope are not allowed to change once initialized.
&lt;/li&gt;
&lt;li&gt;Variables either marked as &lt;code&gt;final&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;Or for &lt;code&gt;effectively final&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;the variables have to be initialized within the enclosing
method before the lambda expression is defined.
&lt;/li&gt;
&lt;li&gt;the values of these variable don't change anywhere else.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;In Scala, it is only supported from version 2.12, so a scala
function literal can be used for a &lt;b&gt;SAM&lt;/b&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;If a &lt;code&gt;trait/abstract class&lt;/code&gt; with exactly one &lt;code&gt;abstract&lt;/code&gt; method,
then a &lt;b&gt;Function&lt;/b&gt; of the same parameter and return type of the
abstract method can be converted into the &lt;code&gt;trait/abstract
      class&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;Example:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;trait&lt;/span&gt; &lt;span class="nc"&gt;Flyable&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="n"&gt;fly&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;miles&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Int&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Unit&lt;/span&gt;
  &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"Unindentified Flyable Object"&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;ufo&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Flyable&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Int&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;s"&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="n"&gt;ufo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s"&gt; flies &lt;/span&gt;&lt;span class="si"&gt;$m&lt;/span&gt;&lt;span class="s"&gt; miles"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ufo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fly&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;123&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;//Unidentified Flyable Object files 123 miles!&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Picking an element from collection, using &lt;code&gt;findFirst()&lt;/code&gt; method,
which return a &lt;code&gt;Optional&lt;/code&gt;:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Optional&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;foundName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
   &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
      &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;startsWith&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"N"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
      &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findFirst&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;reduce&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;An &lt;code&gt;Optional reduce(BinaryOperator bo)&lt;/code&gt; example, finding the name with the longest length:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Optional&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;aLongName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
   &lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;
     &lt;span class="n"&gt;reduce&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;name1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name2&lt;/span&gt;&lt;span class="o"&gt;)=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;name1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;name2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;name1&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;name2&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;aLongName&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ifPresent&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"A long name: "&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;As the &lt;code&gt;reduce()&lt;/code&gt; method iterated through the collection, it called
the lambda expression first with the first two elements in the
list.
&lt;/li&gt;
&lt;li&gt;The result is used as the &lt;b&gt;first&lt;/b&gt; parameter in the following calls.
&lt;/li&gt;
&lt;li&gt;The result from the final call is returned as the result of the
&lt;code&gt;reduce()&lt;/code&gt; method call.
&lt;/li&gt;
&lt;li&gt;The result of &lt;code&gt;reduce()&lt;/code&gt; is an &lt;code&gt;Optional&lt;/code&gt; because the collection
on which is called may be empty.
&lt;/li&gt;
&lt;li&gt;If the list had only one element, the &lt;code&gt;reduce()&lt;/code&gt; would return that
element and the lambda expression would not be invoked.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Another form of &lt;code&gt;reduce&lt;/code&gt; looks like:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;steveOrLonger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
    &lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;reduce&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"steve"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
	    &lt;span class="n"&gt;name1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;name2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;name1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name2&lt;/span&gt;
	&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;It takes a base value, and not return an &lt;code&gt;Optional&lt;/code&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Join elements:
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;code&gt;String&lt;/code&gt; has an added convenience method &lt;code&gt;join()&lt;/code&gt;:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;join&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;", "&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Under the hood, the &lt;code&gt;join()&lt;/code&gt; method calls upon the &lt;code&gt;StringJoiner&lt;/code&gt;
    to concatenate the values.
&lt;/li&gt;
&lt;li&gt;We could use the &lt;code&gt;reduce()&lt;/code&gt; method to concatenate elements into a
string, but JDK has a &lt;code&gt;collect()&lt;/code&gt; method, which is another form of
&lt;code&gt;reduce&lt;/code&gt; that can help collect values into a target destination:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;friends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;toUpperCase&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;collect&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Collectors&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;joining&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;", "&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;StringJoiner&lt;/code&gt; gives more control over the format of
concatenation; we can specify a prefix, a suffix, and infix
character sequences.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>java</category><guid>https://wudong.graceliu.uk/posts/notes/java-interview-questions/</guid><pubDate>Thu, 13 Jul 2017 23:00:00 GMT</pubDate></item><item><title>Java Problems</title><link>https://wudong.graceliu.uk/posts/notes/java-problems/</link><dc:creator>Warren Liu</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-problems/#sec-1"&gt;Unable to connect through SSL/HTTPS&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-problems/#sec-1-1"&gt;The problem&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-problems/#sec-1-2"&gt;Cause&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-problems/#sec-1-3"&gt;Resolution&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-problems/#sec-1-4"&gt;Specific on the Letsencrypt certificates&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;Unable to connect through SSL/HTTPS&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;/div&gt;&lt;div id="outline-container-sec-1-1" class="outline-3"&gt;
&lt;h3 id="sec-1-1"&gt;The problem&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-1"&gt;
&lt;p&gt;
When trying to connect through a HTTPS connection, the java
HTTPConnection through the following exception:
&lt;/p&gt;
&lt;p class="verse"&gt;
Caused by: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.Alerts.getSSLException(Alerts.java:192) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1949) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:302) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:296) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1509) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:216) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.Handshaker.processLoop(Handshaker.java:979) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.Handshaker.process&lt;sub&gt;record&lt;/sub&gt;(Handshaker.java:914) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:1062) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1375) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1403) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1387) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:559) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:185) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1513) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1441) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
Â Â Â Â Â Â Â Â at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:480) ~[na:1.8.0&lt;sub&gt;65]&lt;/sub&gt;&lt;br&gt;
&lt;/p&gt;
&lt;p&gt;
The HTTPS certficate is issued with letsencrypt.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-2" class="outline-3"&gt;
&lt;h3 id="sec-1-2"&gt;Cause&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-2"&gt;
&lt;p&gt;
Whenever Java attempts to connect to another application over SSL (e.g.: HTTPS,
IMAPS, LDAPS), it will only be able to connect to that application if
it can trust it.
&lt;/p&gt;

&lt;p&gt;
The way trust is handled in the Java world is that you have a keystore
(typically &lt;b&gt;$JAVA&lt;sub&gt;HOME&lt;/sub&gt;/lib/security/cacerts&lt;/b&gt;), also known as the
&lt;b&gt;truststore&lt;/b&gt;. This contains a list of &lt;b&gt;all&lt;/b&gt; known Certificate
Authority (CA) certificates, and Java will only trust certificates
that are signed by one of those CAs or public certificates that exist
within that keystore.
&lt;/p&gt;

&lt;p&gt;
For example, if we look at the certificate for Atlassian, we can see
that the &lt;b&gt;*.atlassian.com&lt;/b&gt; certificate has been signed by the
intermediate certificates, &lt;b&gt;DigiCert High Assurance EV Root CA&lt;/b&gt; and
&lt;b&gt;DigiCert High Assurance CA-3&lt;/b&gt;. These intermediate certificates have
been signed by the root &lt;b&gt;Entrust.net Secure Server CA&lt;/b&gt;.
&lt;/p&gt;

&lt;p&gt;
Theese three certificates combined are referred to as the certificate
chain. As they are all within the Java keystore, Java will trust any
certificates signed by them.
&lt;/p&gt;

&lt;p&gt;
Alternatively, if the &lt;b&gt;.atlassian.com&lt;/b&gt; certificate had been in the
keystore, Java would also trust that site.
&lt;/p&gt;

&lt;p&gt;
This problem is therefore caused by a certificate that is &lt;i&gt;self-signed&lt;/i&gt;
(a CA did not sign it) or &lt;b&gt;a certificate chain that does not exist
within the Java truststore&lt;/b&gt;. Java does not trust the certificate and
fails to connect to the application.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-3" class="outline-3"&gt;
&lt;h3 id="sec-1-3"&gt;Resolution&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Make sure you have imported the public certificate of the target
instance into the truststore.
&lt;/li&gt;
&lt;li&gt;Make sure any certificates have been imported into the correct
truststore; you may have multiple JRE/JDKs.
&lt;/li&gt;
&lt;li&gt;Check to see that the correct truststore is in use. If
&lt;b&gt;-Djavax.net.ssl.trustStore&lt;/b&gt; has been configured, it will override
the location of the default truststore, which will need to be
checked.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1-4" class="outline-3"&gt;
&lt;h3 id="sec-1-4"&gt;Specific on the Letsencrypt certificates&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-1-4"&gt;
&lt;p&gt;
Up until Java 8u101, Java don't trust Let's Encrypt certificates out
of the box. The truststore of Oracle JDK/JRE contains neither the
Let's Encrypt CA specifically, or the IdenTrust CA that cross signed it.
&lt;/p&gt;

&lt;p&gt;
For a local configuration changes:
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;keytool -trustcacerts &lt;span class="se"&gt;\&lt;/span&gt;
    -keystore &lt;span class="nv"&gt;$JAVA_HOME&lt;/span&gt;/jre/lib/security/cacerts &lt;span class="se"&gt;\&lt;/span&gt;
    -storepass changeit &lt;span class="se"&gt;\&lt;/span&gt;
    -noprompt &lt;span class="se"&gt;\&lt;/span&gt;
    -importcert &lt;span class="se"&gt;\&lt;/span&gt;
    -file /etc/letsencrypt/live/hostname.com/chain.pem
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
To update the java version to the latest on RaspberryPi, following:
&lt;a href="https://www.linuxbabe.com/desktop-linux/install-oracle-java-8-debian-jessie-raspbian-jessie-via-ppa"&gt;https://www.linuxbabe.com/desktop-linux/install-oracle-java-8-debian-jessie-raspbian-jessie-via-ppa&lt;/a&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>java</category><guid>https://wudong.graceliu.uk/posts/notes/java-problems/</guid><pubDate>Thu, 13 Jul 2017 23:00:00 GMT</pubDate></item><item><title>Java Troubleshotting Note</title><link>https://wudong.graceliu.uk/posts/notes/java-troubleshooting/</link><dc:creator>Warren Liu</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-troubleshooting/#sec-1"&gt;Options/Flags for JVM trobuleshotting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-troubleshooting/#sec-2"&gt;Java Mission Control&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wudong.graceliu.uk/posts/notes/java-troubleshooting/#sec-3"&gt;Java Flight Recordings&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;Options/Flags for JVM trobuleshotting&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Core files: If java crashes, for example due to a segmentation
fault, the OS saves to disk a core file (complete dump of the
memory).
&lt;ul class="org-ul"&gt;
&lt;li&gt;On linux, using &lt;code&gt;ulimit -c unlimited&lt;/code&gt; before starting the
application will usually enable core file dump.
&lt;/li&gt;
&lt;li&gt;to force on core file when the application cannot be closed
properly, using &lt;br&gt;
    &lt;code&gt;kill -6 &amp;lt;pid&amp;gt;&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Heap dump: add &lt;code&gt;-XX:+HeapDUmpOnOutOfMemoryError&lt;/code&gt; flags save java
heap dump to disk if the application runs into an
&lt;b&gt;OutOfMemoryError&lt;/b&gt;. &lt;code&gt;jhat&lt;/code&gt; can be used to inspect the Java heap.
&lt;/li&gt;
&lt;li&gt;Using a continious Java flight recording (JFR).
&lt;ul class="org-ul"&gt;
&lt;li&gt;The JFR events can be extremely helpful to debug a wide range of
issues from &lt;i&gt;memory leaks&lt;/i&gt; to &lt;i&gt;network errors&lt;/i&gt;, high CPU usage/, &lt;i&gt;thread
blocks&lt;/i&gt;, etc.
&lt;/li&gt;
&lt;li&gt;The overhead of running with a continious flight recording is &lt;b&gt;very low&lt;/b&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Verbose GC with &lt;code&gt;-verbosegc&lt;/code&gt;:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Does GC run for a long time?
&lt;/li&gt;
&lt;li&gt;Does the free memory decrease over time?
&lt;/li&gt;
&lt;li&gt;Use flags &lt;code&gt;UseGClogFileRotation&lt;/code&gt; and &lt;code&gt;NumberOfGCLogFiles&lt;/code&gt; to set
up log rotation.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Print Java version and JVM flags:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Using &lt;code&gt;-XX:+PrintCommandLineFlags&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;and &lt;code&gt;-showversion&lt;/code&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Set up JMC JMX for remote monitoring:
&lt;ul class="org-ul"&gt;
&lt;li&gt;There is no performance overhead in enabling JMX
&lt;/li&gt;
&lt;li&gt;To enable JMX after java application has started using the
diagnostic command &lt;b&gt;ManageAgent.start&lt;/b&gt;, run &lt;br&gt;
    &lt;code&gt;jcmd &amp;lt;pid&amp;gt; help ManagementAgent.start&lt;/code&gt; &lt;br&gt;
    for a list of flags that can be send with the command
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-2" class="outline-2"&gt;
&lt;h2 id="sec-2"&gt;Java Mission Control&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Java Management console (JMX) connects to a running JVM, collects
and displays key characterstics in real time.
&lt;/li&gt;
&lt;li&gt;Java Flight Recordings (JFR) is available to analyze events.
&lt;/li&gt;
&lt;li&gt;JMC can &lt;i&gt;trigger&lt;/i&gt; user &lt;span class="underline"&gt;provided custom actions and rules&lt;/span&gt; for JVM.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;DTrace&lt;/b&gt; plugin is an extended &lt;b&gt;DScript&lt;/b&gt; language to produce self
describing events.
&lt;/li&gt;
&lt;li&gt;&lt;b&gt;JOverview&lt;/b&gt; plugin is a tool for analyzing heap waste (emtpy/sparse
collections), which use hprof dumps.
&lt;/li&gt;
&lt;li&gt;The JMC plugins connect to JVM using JMX agents.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-3" class="outline-2"&gt;
&lt;h2 id="sec-3"&gt;Java Flight Recordings&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The JFR records detailed information about the java runtime and the
java application running in the java runtime with little overhead.
&lt;/li&gt;
&lt;li&gt;Typical events can be threads waiting for locks, GC, periodic CPU
usage data, etc.
&lt;/li&gt;
&lt;li&gt;When creating a flight recording, you select which events should be
saved, which is called a &lt;b&gt;recording template&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;A &lt;b&gt;Continuous Recording&lt;/b&gt; is a recording that is always on and
saves, for example, the last six hours of data.
&lt;ul class="org-ul"&gt;
&lt;li&gt;The default setting for it is to use a recording profile with
extremely low overhead.
&lt;/li&gt;
&lt;li&gt;It is great to always have running. The recoding can be dumped
manually using either &lt;b&gt;JCMD&lt;/b&gt; or &lt;b&gt;JMC&lt;/b&gt;, or set a trigger in JMC to
dump when some criteria is fulfilled.
&lt;/li&gt;
&lt;li&gt;It can be started from the command line using &lt;code&gt;-XX:FlightRecorderOptions&lt;/code&gt;.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;A &lt;b&gt;Profiling Recordings&lt;/b&gt; is a recording that is turned on, runs for
a set amount of time, and then stops. It might have slightly bigger
performance impact. It typical usage includes:
&lt;ul class="org-ul"&gt;
&lt;li&gt;Profile what methods are run the most and where most objects are created.
&lt;/li&gt;
&lt;li&gt;Look for classes that use more and more heap indicating a memory leak.
&lt;/li&gt;
&lt;li&gt;Look for bottle necks due to synchronization.
&lt;/li&gt;
&lt;li&gt;The typical overhead for a profiling recording is about &lt;b&gt;2 precent&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;It can be started at the start of the application using
&lt;code&gt;-XX:StartFlightRecording&lt;/code&gt; option. For example:&lt;br&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;java -XX:+UnlockCommercialFeatures -XX:+FlightRecorder &lt;span class="se"&gt;\&lt;/span&gt;
     -XX:StartFlightRecording&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;delay&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;20s,duration&lt;span class="o"&gt;=&lt;/span&gt;60s,name&lt;span class="o"&gt;=&lt;/span&gt;myrecording,&lt;span class="se"&gt;\&lt;/span&gt;
     &lt;span class="nv"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;C:&lt;span class="se"&gt;\T&lt;/span&gt;EMP&lt;span class="se"&gt;\m&lt;/span&gt;yrecording.jfr,settings&lt;span class="o"&gt;=&lt;/span&gt;profile MyApp
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Prior to JDK 8u40 release, the JVM must also have been started with
the flag: &lt;code&gt;-XX:+UnlockCommercialFeatures -XX:FlightRecorder&lt;/code&gt;. Since
&lt;b&gt;JDK 8u40&lt;/b&gt;, the JFR can &lt;i&gt;be enabled during &lt;b&gt;runtime&lt;/b&gt;&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;You can also set up JMC to automatically start or dump a flight
recording if a condition is met.
&lt;ul class="org-ul"&gt;
&lt;li&gt;There are several default triggers set up for common conditions
such as high CPU usage, deadlocked threads, or too large of a live
set.
&lt;/li&gt;
&lt;li&gt;You can choose to create a trigger on &lt;b&gt;any MBean&lt;/b&gt; in the application.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Most GCs in Java have some kind of smaller garbage collections. The
&lt;i&gt;old GC goes through the entire Java heap&lt;/i&gt;, while the other GC might
look at part of the heap. The heap usage after an old collection is
the memory the application is using, which is called the &lt;b&gt;live set&lt;/b&gt;.
&lt;/li&gt;
&lt;li&gt;For a better way to address memory leaks, look at the &lt;i&gt;&lt;b&gt;Heap After GC&lt;/b&gt;
value in the first and last old GC&lt;/i&gt;. There could be a memory leak when
&lt;i&gt;this value is increasing over time&lt;/i&gt;.
&lt;/li&gt;
&lt;li&gt;&lt;i&gt;Small objects&lt;/i&gt; in Java are allocated in a &lt;b&gt;TLAB (Thread Local Area
Buffer)&lt;/b&gt;.
&lt;ul class="org-ul"&gt;
&lt;li&gt;TLAB is a small memory area where new objects are allocated.
&lt;/li&gt;
&lt;li&gt;Once a TLAB is full, the thread gets a new one. Logging all memory
allocations gives an overhead; therefore, all allocations that
triggered a new TLAB are logged.
&lt;/li&gt;
&lt;li&gt;Larger objects are allocated outside TLAB, which are also logged.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;/li&gt;&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>java</category><guid>https://wudong.graceliu.uk/posts/notes/java-troubleshooting/</guid><pubDate>Thu, 13 Jul 2017 23:00:00 GMT</pubDate></item></channel></rss>